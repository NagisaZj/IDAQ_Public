import numpy as np
import matplotlib.pyplot as plt



returns = []
path = './data/pick-place-v2'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 53.51816940307617, 5.838357602832252 ,
61.90818405151367, 5.614027455410069 ,
13.321465492248535, 7.597040151533288 ,
4.939723968505859, 1855.8746529670814 ,
18.38674545288086, 8.54806149243494 ,
3.838477849960327, 9.446475751575147 ,
25.627731323242188, 3979.220895895244 ,
1.832807183265686, 5.932414058324234 ,
2.9445159435272217, 3.8882630850274467 ,
41.85581970214844, 4.592399229753707 ,
32.90353775024414, 3615.0778816968464 ,
6.490095615386963, 437.1280850958836 ,
50.61835861206055, 7.292379532355765 ,
6.753067970275879, 5.509521728172819 ,
110.92742919921875, 5.72610418061064 ,
54.44633483886719, 1194.3771727813905 ,
23.220436096191406, 7.294972356433307 ,
2.0459415912628174, 13.229396961599097 ,
0.07558393478393555, 3.2901060935469673 ,
0.11704792827367783, 6.608592932275162 ,
4.38352632522583, 15.645011355797974 ,
4.918399810791016, 23.187718873111592 ,
32.641258239746094, 4.1403001198978675 ,
45.17783737182617, 235.4865743518183 ,
26.770736694335938, 1413.8717986772224 ,
88.00283813476562, 5.873295603320795 ,
35.177276611328125, 11.373332680610535 ,
0.057327330112457275, 8.456481079326991 ,
0.18631531298160553, 4.062960544441011 ,
29.50515365600586, 5.964161715583795 ,
74.706787109375, 4.585393921163259 ,
48.251461029052734, 5.030469341017099 ,
32.14791488647461, 8.565894771266343 ,
67.8815689086914, 6.853492669631862 ,
26.103939056396484, 5.74018876850214 ,
41.30248260498047, 222.2095821730537 ,
21.066892623901367, 2606.159762939488 ,
11.625505447387695, 93.1236453956324 ,
3.1400980949401855, 5.561933638341538 ,
39.90625, 4.876721150480289 ,
4.344045162200928, 2873.7799055185087 ,
26.824562072753906, 6.465535055576781 ,
35.558895111083984, 34.945272185041986 ,
40.01537322998047, 4.353469815075704 ,
17.803241729736328, 6.250307575518774 ,
53.05329895019531, 4.477502627977706 ,
120.42280578613281, 6.106528934771582 ,
26.81475830078125, 6.449322581741697 ,
7.30875301361084, 3072.140191824008 ,
32.34951400756836, 21.425148541270094 ,
 11.587112426757812 , 1219.7361355957828 ,
 101.45198059082031 , 5.201573318246125 ,
 96.77689361572266 , 3.2720697866680557 ,
 194.29640197753906 , 5.8955220035774465 ,
 21.136629104614258 , 81.27664920713207 ,
 92.6089096069336 , 4.5329328275576835 ,
 1.2458124160766602 , 232.85565118805408 ,
 29.983259201049805 , 7.281654892068804 ,
 5.7603044509887695 , 6.5290556285855885 ,
 67.45762634277344 , 5.279274304786803 ,
 1.48004150390625 , 10.505046646720864 ,
 46.183448791503906 , 46.30969819307586 ,
 66.358154296875 , 4.397486819396079 ,
 3.9219400882720947 , 12.977893351120098 ,
 71.46258544921875 , 171.96643939504938 ,
 0.6766157150268555 , 6.339981538152721 ,
 159.83822631835938 , 4.949665304126314 ,
 0.6983776688575745 , 55.4069679447107 ,
 24.009288787841797 , 5.8299307078252465 ,
 40.472103118896484 , 41.97029763164919 ,
 11.497091293334961 , 1443.1947014240177 ,
 95.76599884033203 , 3.8916996380420046 ,
 137.02304077148438 , 6.30957977334327 ,
 0.30070891976356506 , 120.35481721317981 ,
 138.06703186035156 , 4.950444098565468 ,
 3.6944353580474854 , 6.068381764399523 ,
 7.844355583190918 , 25.645531500142415 ,
 13.128387451171875 , 7.544430693891079 ,
 23.342992782592773 , 6.872027402965504 ,
 32.08308410644531 , 156.74887733583608 ,
 114.0150146484375 , 5.451327620656887 ,
 41.05880355834961 , 4.876026827429534 ,
 5.163279056549072 , 6.841714552918242 ,
 35.609100341796875 , 7.139883147195821 ,
 74.2182846069336 , 11.44894125556784 ,
 18.205860137939453 , 7.350244507017516 ,
 0.2040541172027588 , 2.6221063576504893 ,
 44.539459228515625 , 9.385954447196234 ,
 5.802105903625488 , 8.590616146050015 ,
 5.918331146240234 , 9.5133631081926 ,
 56.786834716796875 , 6.398882818713016 ,
 0.5807315111160278 , 3.3727725589776627 ,
 1.459648847579956 , 6.45344158458355 ,
 4.131967544555664 , 10.364777705351015 ,
 118.09880828857422 , 6.502116063031163 ,
 151.5960235595703 , 5.907865057526066 ,
 14.176552772521973 , 48.6408097660636 ,
 9.098533630371094 , 7.084337033445911 ,
 21.940767288208008 , 138.96214084880506 ,
 162.99832153320312 , 5.770972092016155 ,
 42.78928756713867 , 35.01613385966958 ,
 27.48733139038086 , 23.421684055338872 ,
 11.22719669342041 , 2181.8175851019546 ,
 26.56234359741211 , 6.183242001954172 ,
 105.07377624511719 , 5.2222612072007415 ,
 1.0145565271377563 , 764.9113976537118 ,
 0.41872626543045044 , 4.88723644607601 ,
 5.271810054779053 , 10.292696148033334 ,
 27.316287994384766 , 4.434519747437817 ,
 14.33479118347168 , 23.551323411591436 ,
 10.445622444152832 , 5.45775230156113 ,
 46.575096130371094 , 5.988129331458638 ,
 1.4233896732330322 , 7.324596164868653 ,
 40.05119323730469 , 645.9915080245402 ,
 28.5261173248291 , 33.84032323611787 ,
 19.262832641601562 , 3.842018893617177 ,
 27.495988845825195 , 27.829485210982487 ,
 81.15545654296875 , 7.660305023476447 ,
 29.82526206970215 , 8.842274716643047 ,
 116.81892395019531 , 5.796471662051819 ,
 0.06351472437381744 , 4.7776225066641755 ,
 4.046088218688965 , 9.501946856968802 ,
 24.499418258666992 , 8.102845330803548 ,
 47.72732925415039 , 5.954272982759425 ,
 23.119667053222656 , 3.6517665354005144 ,
 22.873029708862305 , 54.039952617634725 ,
 6.615367412567139 , 4.033482953852128 ,
 154.14923095703125 , 5.045217422367862 ,
 65.37989044189453 , 4.420796845889108 ,
 234.38528442382812 , 2.727051281093403 ,
 3.506472110748291 , 5.473676170507876 ,
 98.7783203125 , 6.565602962186293 ,
 5.899560928344727 , 8.036880662163798 ,
 5.578115463256836 , 5.053403011509424 ,
 0.12450241297483444 , 4.526758632266063 ,
 117.65131378173828 , 5.781605888781865 ,
 9.942268371582031 , 5.6010825978989836 ,
 16.566661834716797 , 913.2923140750199 ,
 7.960701942443848 , 448.5032782005196 ,
 40.74907684326172 , 8.52607870591544 ,
 116.02931213378906 , 4.865534113616505 ,
 22.338674545288086 , 6.034858490902019 ,
 39.42091369628906 , 5.8636618756037535 ,
 10.440177917480469 , 11.104019439936273 ,
 90.75994873046875 , 48.705190388530696 ,
 40.491214752197266 , 5.73327683905607 ,
 7.643286228179932 , 9.252196248861138 ,
 48.44209289550781 , 3.2196215538695974 ,
 10.615447998046875 , 9.836634246620786 ,
 24.078969955444336 , 756.1368284627788 ,
 111.22078704833984 , 4.160872078220942 ,
 81.18341064453125 , 6.169687195651433 ,
 1.5904704332351685 , 324.797486708733 ,
 54.564109802246094 , 4.435256420509869 ,
 43.50634002685547 , 12.720925228668849 ,
 34.07915496826172 , 5.133971127992375 ,
 18.17655372619629 , 4.268724880729893 ,
 5.519320964813232 , 68.95295460033846 ,
 107.7955322265625 , 7.074985794556881 ,
 42.12067413330078 , 11.793957154529636 ,
 25.474672317504883 , 7.878717030625253 ,
 36.678009033203125 , 7.556648515492964 ,
 20.11933708190918 , 2.6142662556550023 ,
 29.616613388061523 , 8.490281210226893 ,
 44.4820556640625 , 10.062886220907378 ,
 3.9965479373931885 , 20.4193107895425 ,
 29.746868133544922 , 14.240172927058076 ,
 33.141639709472656 , 5.66373744283914 ,
 41.69767761230469 , 4.097227845718244 ,
 23.623096466064453 , 5.365141167746241 ,
 0.3560417890548706 , 22.356899813631713 ,
 31.84271240234375 , 4.048854869662007 ,
 4.867363929748535 , 13.650887927859486 ,
 57.52467727661133 , 22.81820387194621 ,
 0.642280638217926 , 15.354635953615995 ,
 43.13145446777344 , 3.517579627900047 ,
 20.815629959106445 , 5.290057504522784 ,
 4.722962379455566 , 513.2836898604552 ,
 38.93124771118164 , 9.906808326342421 ,
 4.720405101776123 , 1206.7224994479461 ,
 75.83840942382812 , 4.215250413288179 ,
 8.576183319091797 , 7.7676463078425035 ,
 5.169876575469971 , 30.430633611063158 ,
 29.479698181152344 , 3.9723558511536394 ,
 5.199466705322266 , 5.907411994119599 ,
 30.080116271972656 , 383.95560961536734 ,
 31.355226516723633 , 37.46479265177038 ,
 45.14265060424805 , 8.847704382390985 ,
 13.210847854614258 , 1962.6067365044942 ,
 3.536980628967285 , 4.776917618351515 ,
 148.957275390625 , 5.625581789910806 ,
 0.46239173412323 , 139.16772534340942 ,
 29.332494735717773 , 719.2988803385078 ,
 39.055843353271484 , 7.980358532234969 ,
 28.205595016479492 , 3.029116162112173 ,
 32.09071731567383 , 975.0381265498027 ,
 86.01895141601562 , 19.21328169244226 ,
 5.402186393737793 , 18.36398638705107 ,
 33.37312316894531 , 2.2598405106986976 ,
 34.348548889160156 , 1545.6939199356711 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Pick-Place-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 1.1167527437210083 , 4.52094044398362 ,
 3.1794545650482178 , 7.676447804926063 ,
 1.2129186391830444 , 5.739153758376949 ,
 2.3379321098327637 , 5.614967397895509 ,
 1.0830498933792114 , 116.08344545128853 ,
 1.678099274635315 , 3.2184175120907668 ,
 1.9913671016693115 , 90.39821562677196 ,
 1.8417028188705444 , 4234.363722508264 ,
 2.5317161083221436 , 6.554744591187432 ,
 1.781859278678894 , 7.4788908630543425 ,
 2.0846216678619385 , 3046.4818568744668 ,
 2.0684096813201904 , 5.417242698027859 ,
 3.1199326515197754 , 5.727823734025041 ,
 0.30690425634384155 , 59.72580855354829 ,
 1.6150152683258057 , 5.667627339805607 ,
 2.7497453689575195 , 5.372528041779586 ,
 2.4018402099609375 , 172.4509100868858 ,
 2.643181800842285 , 3.3444249165954902 ,
 0.9745334386825562 , 4.817715261442595 ,
 1.7961857318878174 , 35.10093736183188 ,
 0.4399341940879822 , 6.830566319890241 ,
 2.060201644897461 , 4.3633022343688985 ,
 2.3618392944335938 , 54.59689712462858 ,
 2.0147523880004883 , 4.728478083837339 ,
 4.471097469329834 , 6.279951770354391 ,
 4.791306972503662 , 18.126010793986882 ,
 2.449678897857666 , 6.47099832795613 ,
 1.715062141418457 , 1411.2496557753293 ,
 2.2352168560028076 , 6.613080872253203 ,
 2.5871217250823975 , 7.693035635134144 ,
 1.4269731044769287 , 13.358319404953138 ,
 2.4185988903045654 , 6.740164359816854 ,
 2.041152238845825 , 3.487215963857698 ,
 1.2631926536560059 , 7.382312204411289 ,
 1.2280066013336182 , 3.6910999903933295 ,
 2.1162593364715576 , 515.0539083973283 ,
 2.329720973968506 , 10.93723624987499 ,
 2.7754921913146973 , 635.7600735499531 ,
 0.8523817658424377 , 5.697422048226597 ,
 1.616937518119812 , 5.7371974348693175 ,
 1.567535400390625 , 4.211662877630703 ,
 4.242853164672852 , 12.788348726564513 ,
 2.292620897293091 , 6.4987349468351185 ,
 2.0048201084136963 , 1389.5941672721146 ,
 1.4885600805282593 , 37.43870351825238 ,
 3.0833120346069336 , 20.69149563777361 ,
 0.8245447278022766 , 5.501479695211442 ,
 1.2357488870620728 , 7.061079271705589 ,
 2.5666940212249756 , 5.825357935700827 ,
 1.8218497037887573 , 6.926903396159594 ,
 2.9271843433380127 , 4.258844879751592 ,
 3.5749661922454834 , 19.3957489759891 ,
 2.0202951431274414 , 77.58028558436125 ,
 0.3499768376350403 , 71.47881328158098 ,
 1.8547468185424805 , 4.054193836464757 ,
 0.5684033036231995 , 10.290627180951555 ,
 1.4533506631851196 , 4.567651278896767 ,
 0.19295634329319 , 6.831783998617317 ,
 3.6087594032287598 , 5.942579268378354 ,
 3.220615863800049 , 5.4627971897542 ,
 2.9025912284851074 , 535.2020457722127 ,
 2.6093597412109375 , 5.192883466112829 ,
 3.0944576263427734 , 1419.4833806115512 ,
 4.367605686187744 , 4.141732464863297 ,
 2.676853656768799 , 5.4853265622091865 ,
 2.225100517272949 , 92.84109264196798 ,
 1.3920607566833496 , 7.401143970604963 ,
 2.4026999473571777 , 7.3662273850395525 ,
 2.782557249069214 , 184.10506135628628 ,
 0.22753788530826569 , 16.36279948812278 ,
 2.1818654537200928 , 7.678648536732973 ,
 0.6373626589775085 , 4.847341446322211 ,
 1.4071016311645508 , 5.611164257120872 ,
 0.5327665209770203 , 7.425610484966427 ,
 2.9912970066070557 , 12.136673964573262 ,
 2.610821008682251 , 5.149127443372359 ,
 1.2063086032867432 , 53.84259887759458 ,
 1.5914397239685059 , 17.332581334112984 ,
 1.9198267459869385 , 4.338391679794897 ,
 2.988025426864624 , 2.664232807480895 ,
 0.11923622339963913 , 4.614411996789934 ,
 2.172743558883667 , 583.1553882871742 ,
 3.9707045555114746 , 3420.753584845932 ,
 1.798165202140808 , 5.95802699382856 ,
 1.9113540649414062 , 6.666750602584259 ,
 2.225100517272949 , 92.84109264196798 ,
 3.013829231262207 , 7.106091000644783 ,
 0.42334994673728943 , 2.8513011192565747 ,
 2.553147077560425 , 6.572140565267588 ,
 3.5316600799560547 , 11.275396453113528 ,
 1.7114183902740479 , 4.421455933115187 ,
 2.6275696754455566 , 5.778474297510824 ,
 1.730616807937622 , 1268.0926687280248 ,
 0.786446750164032 , 120.32903404043917 ,
 0.9930615425109863 , 4.36187166526577 ,
 3.171538829803467 , 4.739889792264325 ,
 2.4054954051971436 , 5.723651289103354 ,
 1.998226284980774 , 356.51008099723776 ,
 2.19146466255188 , 5.454590224533247 ,
 2.183454990386963 , 6.377019412945897 ,
 2.0673882961273193 , 7.798011484960373 ,
 2.4445972442626953 , 9.1754559670486 ,
 2.4493203163146973 , 6.665586641386443 ,
 4.148245811462402 , 9.315644778471523 ,
 1.629675269126892 , 29.431327612655036 ,
 4.0455732345581055 , 1115.5175186335578 ,
 5.307224273681641 , 8.053825473566091 ,
 0.3184235095977783 , 5.454662859569433 ,
 1.4448511600494385 , 287.53969606774643 ,
 2.8257200717926025 , 4.498796047090739 ,
 4.25311279296875 , 7.121999782064561 ,
 1.7926599979400635 , 5.557034147216027 ,
 4.813505172729492 , 12.485692383104926 ,
 3.238753318786621 , 16.278441213550504 ,
 3.172189474105835 , 16.34325531567121 ,
 2.6937036514282227 , 9.772651310509339 ,
 2.3203160762786865 , 6.293464720323438 ,
 1.3118650913238525 , 1272.4079316074572 ,
 3.2350919246673584 , 7.807448740529709 ,
 2.6480705738067627 , 38.030012459491516 ,
 3.9139668941497803 , 5.310473218398162 ,
 4.288177490234375 , 7.634179541332317 ,
 2.176665782928467 , 7.608106600149344 ,
 1.2853292226791382 , 4.452613563472766 ,
 0.9920172095298767 , 5.72088613421678 ,
 2.517179250717163 , 332.7546060836703 ,
 0.9978463053703308 , 8.055386797318334 ,
 1.9997262954711914 , 296.7450991689982 ,
 1.575208306312561 , 7.992783459880498 ,
 1.202400803565979 , 26.27056422595554 ,
 3.7413907051086426 , 16.858196126329986 ,
 2.983393669128418 , 6.992698587160655 ,
 1.2351237535476685 , 7.503016259587457 ,
 1.3360036611557007 , 4.068283974561176 ,
 1.8248951435089111 , 4.21388831097079 ,
 2.3338558673858643 , 4.2252458623334785 ,
 1.1831032037734985 , 5.392661692656516 ,
 1.6083039045333862 , 5.377366244373004 ,
 2.0350213050842285 , 1935.0112720576367 ,
 2.718703031539917 , 930.7630955064503 ,
 2.1873037815093994 , 7.140247271982366 ,
 0.3469623029232025 , 132.7282519140138 ,
 2.917184352874756 , 641.8383632959087 ,
 2.946367025375366 , 484.9728385898187 ,
 0.6220309138298035 , 5.449347282261353 ,
 4.357896327972412 , 626.1158227279589 ,
 2.8781650066375732 , 10.597369536599565 ,
 3.386279344558716 , 7.723383088035051 ,
 4.011845111846924 , 4.422143984545254 ,
 3.96504807472229 , 3.3550741345578325 ,
 1.6346940994262695 , 10.40048955931072 ,
 2.9928901195526123 , 10.143003358561451 ,
 1.5761886835098267 , 5.722769162901432 ,
 1.9207909107208252 , 7.525249529907656 ,
 4.459738731384277 , 26.302884304178058 ,
 2.193075656890869 , 4276.698876503966 ,
 3.3106513023376465 , 4.637392769502235 ,
 1.3514152765274048 , 48.978041389912526 ,
 0.9632775783538818 , 6.006824699371561 ,
 1.0148093700408936 , 11.309138704073824 ,
 1.8919894695281982 , 8.440169947307021 ,
 2.944234848022461 , 5.9333631697771425 ,
 0.8994241952896118 , 28.631719482517582 ,
 1.8260537385940552 , 59.90915400212622 ,
 4.512452125549316 , 6.101549972660896 ,
 3.5074594020843506 , 4.22640606680444 ,
 3.110286235809326 , 4.574684268677409 ,
 2.360973834991455 , 36.59335367926687 ,
 3.6486973762512207 , 4.502505574462211 ,
 1.984523892402649 , 10.685749946505162 ,
 2.2187063694000244 , 4.681812691504659 ,
 7.0180230140686035 , 5.089427754929594 ,
 2.551246404647827 , 8.076462480040199 ,
 2.1795499324798584 , 7.168704411907624 ,
 0.9109807014465332 , 16.099073475859974 ,
 4.964275360107422 , 63.39443933560363 ,
 1.652378797531128 , 7.982663703465413 ,
 1.0379396677017212 , 7.155972047971954 ,
 2.516972064971924 , 518.3943564073825 ,
 2.011869192123413 , 5.555726122369281 ,
 0.15314579010009766 , 13.317568879071086 ,
 0.6711367964744568 , 7.923763602147005 ,
 2.778123378753662 , 3531.9157609003137 ,
 0.9498911499977112 , 7.963149612166568 ,
 1.3281276226043701 , 7.723468133445494 ,
 4.860758304595947 , 6.872147975425437 ,
 2.6672210693359375 , 14.490268953165035 ,
 2.9458065032958984 , 11.684693291815591 ,
 2.7841193675994873 , 5.327272687959823 ,
 4.413547992706299 , 5.53794247861209 ,
 1.7634940147399902 , 5.454279115308462 ,
 1.9045629501342773 , 4.846426105566412 ,
 1.6411781311035156 , 7.852298126508513 ,
 4.1189117431640625 , 11.330819075067115 ,
 0.5835290551185608 , 15.190201096241237 ,
 1.6955420970916748 , 6.929394532430699 ,
 0.9386687278747559 , 15.583095879230209 ,
 1.4938453435897827 , 4.649863904890111 ,
 3.1553399562835693 , 5.79975521481625 ,
 4.102680683135986 , 1178.6337902069902 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Pick-Place-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()


returns = []
path = './data/reach-v2'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 50.20945358276367, 1315.1795971102638 ,
0.08567540347576141, 4820.846736997737 ,
45.090431213378906, 1333.7462796107409 ,
20.724132537841797, 1526.6268799029342 ,
16.727602005004883, 2319.2158038320877 ,
37.265037536621094, 1866.643094161273 ,
66.72853088378906, 928.0905043708345 ,
38.84560012817383, 1770.6512097091108 ,
15.919288635253906, 3166.013943505261 ,
49.34836959838867, 1418.2171652648417 ,
30.828144073486328, 2152.3486176604897 ,
12.96423053741455, 2273.034483867529 ,
0.5949293375015259, 4479.728912060447 ,
28.334125518798828, 2195.054615675849 ,
34.318389892578125, 1941.2858842747503 ,
50.21333312988281, 1338.5651700676049 ,
6.888359069824219, 3338.100818242413 ,
1.887019395828247, 4199.004286686591 ,
47.813133239746094, 1447.0462072627806 ,
12.461556434631348, 3133.973375832513 ,
0.12958234548568726, 4858.002081355944 ,
57.01594924926758, 1109.6674787003108 ,
50.4102668762207, 1385.8979730737403 ,
20.982341766357422, 1755.091826889262 ,
45.6544075012207, 1546.0246157633942 ,
21.584924697875977, 2769.6218219179746 ,
15.619338989257812, 2592.809653192443 ,
2.139814853668213, 4245.213622859333 ,
37.371490478515625, 1924.0443409919103 ,
0.10305037349462509, 4809.489742524558 ,
61.730865478515625, 900.2862844686127 ,
67.96253967285156, 711.9732324769333 ,
30.664640426635742, 1000.7112836046322 ,
6.957534313201904, 3531.5074722390186 ,
56.5865592956543, 1159.6872338148928 ,
42.663604736328125, 1690.3296925474624 ,
33.48175048828125, 2104.6196718310293 ,
64.36614990234375, 1048.8757573407725 ,
1.552151083946228, 4479.84423353366 ,
16.810997009277344, 3032.1716365098055 ,
0.3225342333316803, 4780.4011669651445 ,
38.746063232421875, 1970.450012110795 ,
4.282426834106445, 3941.73385430209 ,
31.429256439208984, 2135.015716713157 ,
7.5515923500061035, 3489.8490846690283 ,
15.228599548339844, 3035.7304346989495 ,
48.7533073425293, 1544.8728759997387 ,
60.203155517578125, 1112.6385748855173 ,
30.150766372680664, 2189.579039992597 ,
62.62725067138672, 984.7331379942842 ,
 7.653692245483398 , 3525.654628435357 ,
 67.08392333984375 , 810.2944863806108 ,
 0.04340381920337677 , 4821.167917288282 ,
 8.488654136657715 , 3458.9537951172556 ,
 30.20966339111328 , 2327.143833342595 ,
 0.3932364583015442 , 4543.599913340598 ,
 52.32941818237305 , 1449.377112663838 ,
 12.272247314453125 , 3203.7904141325935 ,
 40.495338439941406 , 1763.5572972986051 ,
 7.738342761993408 , 3551.781684875503 ,
 29.36750030517578 , 2117.4165554753076 ,
 3.070732593536377 , 4063.5769502094954 ,
 34.023475646972656 , 2412.6179111885176 ,
 24.536592483520508 , 2604.9959755377477 ,
 16.894329071044922 , 2917.7791314794677 ,
 36.432342529296875 , 1202.3716681052933 ,
 45.997074127197266 , 1501.1157009983672 ,
 14.620981216430664 , 2035.90230782475 ,
 12.482572555541992 , 3173.365017107162 ,
 51.215545654296875 , 1249.2155717818582 ,
 0.44067323207855225 , 4518.546831039881 ,
 28.72202491760254 , 2236.7072450185688 ,
 40.43792724609375 , 1776.2575656680333 ,
 30.260665893554688 , 2193.335982771539 ,
 25.910219192504883 , 2262.627847522931 ,
 7.1597418785095215 , 3429.595462406153 ,
 12.118563652038574 , 3093.203101984651 ,
 61.82958984375 , 1000.2641373893869 ,
 5.840043067932129 , 2887.51458456614 ,
 40.65297317504883 , 1758.5203733975807 ,
 30.808238983154297 , 2466.6831192077725 ,
 39.87032699584961 , 1937.1294039297507 ,
 54.60831832885742 , 1357.0010182386786 ,
 20.923614501953125 , 2601.1478688305983 ,
 1.4771192073822021 , 4351.480567002254 ,
 6.082286357879639 , 3515.316454110287 ,
 60.87139129638672 , 1053.3446321072452 ,
 59.940391540527344 , 1019.8404989236647 ,
 17.37308692932129 , 2705.5840040187245 ,
 51.281070709228516 , 1270.2636349731733 ,
 0.106594979763031 , 4822.950495938664 ,
 35.65077209472656 , 2086.7814151906387 ,
 2.919257640838623 , 4035.410102446649 ,
 13.027023315429688 , 3074.2547038758844 ,
 19.518951416015625 , 3329.760503778067 ,
 56.69792556762695 , 1121.0835860211346 ,
 9.00011157989502 , 3612.4856562518207 ,
 1.6697250604629517 , 4195.544085385725 ,
 44.30989456176758 , 1623.9366380130496 ,
 55.85533905029297 , 1173.997032361631 ,
 54.66694641113281 , 1181.6854360818907 ,
 25.396839141845703 , 2333.658763344093 ,
 0.5833602547645569 , 4519.605168759104 ,
 49.989280700683594 , 1365.7942950260044 ,
 49.010276794433594 , 1051.905957226918 ,
 62.25633239746094 , 1030.9550644018977 ,
 0.8157510757446289 , 4762.868683953286 ,
 21.298341751098633 , 2523.1563006757965 ,
 1.831458330154419 , 4556.0004684013165 ,
 15.38051986694336 , 2995.728214898918 ,
 21.333690643310547 , 2530.591988280193 ,
 0.06196077540516853 , 4811.25553473302 ,
 1.9923369884490967 , 2906.997171221475 ,
 36.25045394897461 , 1858.2727743418122 ,
 1.819117546081543 , 4069.6002039471578 ,
 0.23723427951335907 , 4326.047308344292 ,
 31.621562957763672 , 2127.7137242885765 ,
 59.447086334228516 , 1054.0842758753893 ,
 18.327800750732422 , 2782.031382390729 ,
 20.586421966552734 , 2620.836295764714 ,
 41.171844482421875 , 1493.6566613330162 ,
 14.265865325927734 , 3081.6251990401506 ,
 62.235416412353516 , 946.956024630683 ,
 24.975461959838867 , 2158.671134136236 ,
 15.480276107788086 , 2476.6956067504348 ,
 32.98084259033203 , 1993.9473959759475 ,
 12.369839668273926 , 3012.7487895568984 ,
 0.8980228304862976 , 4369.931401753768 ,
 0.941202700138092 , 4324.271728862468 ,
 42.62053680419922 , 1716.3445062229912 ,
 64.89161682128906 , 855.5316122066356 ,
 37.337615966796875 , 971.034858913381 ,
 53.796051025390625 , 1239.8832872558296 ,
 6.7649993896484375 , 3685.35294886441 ,
 29.20399284362793 , 2108.417873349571 ,
 0.17284637689590454 , 4859.253330141597 ,
 61.313018798828125 , 1113.7836330514383 ,
 36.62285614013672 , 1625.6035168019089 ,
 25.989389419555664 , 2454.874427030153 ,
 56.368858337402344 , 1179.253463119808 ,
 46.44117736816406 , 1515.1014592702859 ,
 0.06323371082544327 , 4842.45755636061 ,
 11.112855911254883 , 3371.8512482685724 ,
 39.05449295043945 , 1907.9054267335719 ,
 7.569300651550293 , 3572.8266948834093 ,
 45.707183837890625 , 1582.8908794611727 ,
 50.55278778076172 , 1296.5059950769173 ,
 54.969635009765625 , 945.1521145639674 ,
 40.06300354003906 , 1825.7906245209374 ,
 41.05528259277344 , 1949.8395828781086 ,
 40.48126983642578 , 1684.1331628359644 ,
 26.380847930908203 , 1558.1644804027628 ,
 9.184837341308594 , 3238.520091703866 ,
 60.54187774658203 , 973.4125467663021 ,
 47.6856689453125 , 1395.50687651196 ,
 1.094207525253296 , 3998.610804147894 ,
 64.0166015625 , 919.7328836627207 ,
 21.469635009765625 , 2462.6431877646974 ,
 19.254924774169922 , 2740.6656514468605 ,
 46.826934814453125 , 1506.7743422368276 ,
 14.35714340209961 , 2413.0039623993257 ,
 40.571624755859375 , 1731.631046844133 ,
 25.184959411621094 , 2438.177170023755 ,
 38.58689880371094 , 1776.0883236698878 ,
 25.667787551879883 , 1882.2375364665759 ,
 33.44025802612305 , 1197.3859106668422 ,
 69.07439422607422 , 772.7164869029732 ,
 29.586681365966797 , 2179.7012092493096 ,
 30.099773406982422 , 2210.4400713767673 ,
 18.56212615966797 , 2929.704533952531 ,
 4.353307247161865 , 4006.4558308699 ,
 0.6517837047576904 , 4701.959793842337 ,
 39.99410629272461 , 2103.0320762255806 ,
 0.09738631546497345 , 4797.6630094177035 ,
 0.22120898962020874 , 4718.604840736549 ,
 1.006628155708313 , 3384.978039399032 ,
 62.97863006591797 , 902.2950337165281 ,
 48.64972686767578 , 1323.8550033932647 ,
 21.262409210205078 , 2522.289205971371 ,
 20.42400550842285 , 2657.8339377308002 ,
 11.30904483795166 , 3465.4718403068587 ,
 13.87605094909668 , 2730.068292266589 ,
 0.30101847648620605 , 4742.104630347299 ,
 47.70567321777344 , 1905.3481774430475 ,
 12.05798053741455 , 3155.765790882406 ,
 3.806389093399048 , 3872.4873443954516 ,
 28.023101806640625 , 2130.983940407409 ,
 42.02866744995117 , 1650.0226915208946 ,
 22.651836395263672 , 2434.3391286224887 ,
 47.25418472290039 , 1496.8912739407865 ,
 22.84380340576172 , 2497.7545258272785 ,
 0.7995779514312744 , 4314.938648341929 ,
 57.230865478515625 , 1115.8099526219282 ,
 22.375511169433594 , 2647.9373940194755 ,
 28.051124572753906 , 2348.3149019327966 ,
 57.8126220703125 , 1051.631062334251 ,
 30.46512794494629 , 2131.487023636313 ,
 15.041440963745117 , 3158.8467868212992 ,
 40.40329360961914 , 1511.7671111255984 ,
 0.08103254437446594 , 4678.484317354855 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Reach-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 1.1514767408370972 , 1198.868857481935 ,
 1.4715710878372192 , 1333.8571067655598 ,
 2.586780071258545 , 1713.8694139741779 ,
 1.450514793395996 , 1380.0281493156463 ,
 1.326736569404602 , 1462.5784137663873 ,
 1.534830093383789 , 740.5720354682551 ,
 1.5650345087051392 , 1505.0351686633505 ,
 1.5195623636245728 , 2869.971601876866 ,
 1.3771781921386719 , 1858.8619244412866 ,
 1.4621620178222656 , 1066.4995598600606 ,
 1.2394767999649048 , 1354.2090399767658 ,
 1.0268193483352661 , 1985.1852810550909 ,
 1.4349030256271362 , 2888.1335742231627 ,
 1.446395754814148 , 2745.012462033197 ,
 2.206618070602417 , 2016.9641991734538 ,
 1.5513169765472412 , 4808.385160618949 ,
 1.3424955606460571 , 2174.0736620111265 ,
 1.6483567953109741 , 2396.4132092538616 ,
 1.302664875984192 , 1107.3885601938555 ,
 1.280310869216919 , 2064.5472873957024 ,
 1.3632326126098633 , 1848.3365964268096 ,
 1.6050230264663696 , 4391.641075020629 ,
 1.839237928390503 , 2422.5804283649904 ,
 1.4027862548828125 , 3271.9753017194635 ,
 1.2074202299118042 , 919.3074497262526 ,
 1.4927537441253662 , 2968.3914801456485 ,
 1.494837999343872 , 4804.834740293776 ,
 1.4081982374191284 , 1924.796515110042 ,
 1.3500562906265259 , 4676.009814425523 ,
 1.538002848625183 , 3025.9966343575725 ,
 1.0515601634979248 , 789.7892136681467 ,
 1.7580020427703857 , 1516.415265224847 ,
 1.83041512966156 , 1814.9482822808732 ,
 1.337160348892212 , 1019.1717601358816 ,
 1.2832626104354858 , 814.6314566996704 ,
 1.3783888816833496 , 3079.0636528915966 ,
 1.4957818984985352 , 3987.6485675287204 ,
 1.4105544090270996 , 1172.4146880438157 ,
 1.372704029083252 , 3009.3191809257933 ,
 1.4353842735290527 , 1467.1241375117606 ,
 1.4294648170471191 , 2284.6489674841523 ,
 1.6250920295715332 , 4665.147671233894 ,
 1.5516791343688965 , 2550.044209636725 ,
 1.3704869747161865 , 3286.7497533462456 ,
 1.536814570426941 , 2142.464308544813 ,
 1.4123363494873047 , 1913.6153864792677 ,
 1.4910013675689697 , 1154.8329201274669 ,
 1.5158079862594604 , 1279.055795117158 ,
 1.345286250114441 , 1303.615644032634 ,
 1.4958235025405884 , 3365.8829558542348 ,
 1.6000112295150757 , 3532.5209046319633 ,
 1.4356467723846436 , 1535.1698083704102 ,
 1.3200867176055908 , 2451.40234210095 ,
 1.581052303314209 , 3004.00652952521 ,
 1.2088890075683594 , 812.9110778358247 ,
 1.6589239835739136 , 1289.9296673264903 ,
 1.4897829294204712 , 4864.299984040765 ,
 1.5104591846466064 , 1856.910991169705 ,
 1.4431426525115967 , 2269.8599538425697 ,
 1.5150824785232544 , 3748.563844032932 ,
 1.4615968465805054 , 2918.320964399408 ,
 1.504554033279419 , 4851.654878188872 ,
 1.5180970430374146 , 2786.6701805010734 ,
 1.517190933227539 , 4306.005216965679 ,
 1.6079111099243164 , 2558.6920229473435 ,
 1.8508590459823608 , 1698.4737428091316 ,
 1.538532018661499 , 4179.205809939411 ,
 1.7695749998092651 , 2046.6950898897346 ,
 1.242336630821228 , 1278.0240155090896 ,
 1.448725700378418 , 1437.4803584948986 ,
 1.3880870342254639 , 1422.8365073577368 ,
 1.4967846870422363 , 2019.4680757812998 ,
 1.6450923681259155 , 4463.754148524929 ,
 1.3457282781600952 , 2820.294941481443 ,
 1.5243875980377197 , 4052.3104115664446 ,
 1.5195339918136597 , 1876.8706938507848 ,
 1.3916418552398682 , 4835.9461992904935 ,
 1.5953352451324463 , 2487.8453889125344 ,
 1.330652117729187 , 3269.341387986954 ,
 1.341132402420044 , 4112.693859556373 ,
 1.358841061592102 , 3097.3116139335743 ,
 1.5722317695617676 , 4822.599783416732 ,
 1.4756109714508057 , 1862.4607858851086 ,
 1.5533177852630615 , 2631.326196181062 ,
 1.6173919439315796 , 1360.8467719897421 ,
 1.0315287113189697 , 1032.0597351933295 ,
 1.629801869392395 , 4114.085886280805 ,
 1.9627008438110352 , 2160.3710866640586 ,
 1.6124448776245117 , 1983.2487392280477 ,
 1.280434012413025 , 764.0507004707471 ,
 1.6282060146331787 , 3956.6710831393707 ,
 1.3178378343582153 , 4729.015712053833 ,
 1.605051040649414 , 2810.1540531595588 ,
 1.4876621961593628 , 4714.164489033454 ,
 1.4456157684326172 , 2368.4124914111544 ,
 1.4603947401046753 , 2001.2373227096748 ,
 1.5216401815414429 , 3753.4565183209434 ,
 1.5965745449066162 , 1852.81127379681 ,
 1.5979053974151611 , 1281.927403780298 ,
 1.4560989141464233 , 1173.8934576262996 ,
 1.4350520372390747 , 1181.6854360818907 ,
 1.3943359851837158 , 1175.9915635691439 ,
 1.8486769199371338 , 1184.6457223155423 ,
 1.515899419784546 , 4786.4693171647605 ,
 1.7437862157821655 , 2426.89081681884 ,
 1.5484625101089478 , 989.5026444842123 ,
 1.3921606540679932 , 2992.8955681887637 ,
 1.5601928234100342 , 1265.5436585097739 ,
 1.5369337797164917 , 3058.9328126535684 ,
 1.3666021823883057 , 4812.705888184048 ,
 1.3911921977996826 , 2120.380860866867 ,
 1.2426948547363281 , 1845.1537486377265 ,
 1.402616024017334 , 3536.001752624179 ,
 2.1361687183380127 , 2701.533147293618 ,
 1.268943428993225 , 1851.8949391119131 ,
 1.3792959451675415 , 3841.75096309337 ,
 1.5310251712799072 , 1576.9862238439368 ,
 1.551938772201538 , 3830.0170027304985 ,
 1.217839002609253 , 1159.6587960072754 ,
 1.4844273328781128 , 2974.554165206033 ,
 1.325570821762085 , 985.3261282570218 ,
 1.3410086631774902 , 2517.906999730163 ,
 1.160506248474121 , 1923.2313817461627 ,
 1.489229679107666 , 3458.6311999493364 ,
 1.4980413913726807 , 4539.001459183625 ,
 1.7414872646331787 , 2458.879369948736 ,
 1.5224359035491943 , 3391.487094396881 ,
 1.6104334592819214 , 4377.1008019708925 ,
 1.3971208333969116 , 4008.672580080142 ,
 1.4077352285385132 , 4319.379502848782 ,
 1.3564072847366333 , 964.7810144116603 ,
 1.4743419885635376 , 4531.272560917311 ,
 0.9980872273445129 , 810.7624648262995 ,
 2.1272950172424316 , 1332.3577334957872 ,
 1.3152023553848267 , 775.2967775721768 ,
 1.5309029817581177 , 4364.414098312719 ,
 1.3803068399429321 , 2422.270530654121 ,
 1.65799081325531 , 900.3657314921433 ,
 1.4362447261810303 , 1434.8682714416263 ,
 1.6626663208007812 , 995.7863224820001 ,
 1.6106064319610596 , 1659.2647147558769 ,
 1.4929249286651611 , 4841.728838613957 ,
 1.6019253730773926 , 3275.718430962417 ,
 1.5481868982315063 , 3634.1104311917525 ,
 1.5712870359420776 , 1996.0446618853675 ,
 1.438179850578308 , 1256.8913735611136 ,
 1.5172953605651855 , 1395.3830841873983 ,
 1.6121206283569336 , 1328.8867041926362 ,
 1.4094144105911255 , 1095.5389423484824 ,
 1.5190176963806152 , 2770.762301280023 ,
 1.4808470010757446 , 3329.190322645737 ,
 1.4460529088974 , 1397.4357512194283 ,
 1.2168529033660889 , 1460.5082022268282 ,
 1.4834600687026978 , 1733.9514005499618 ,
 1.7203562259674072 , 1558.0577066495136 ,
 1.5318071842193604 , 2813.6083122575255 ,
 1.398698091506958 , 1190.1287444017328 ,
 1.3604326248168945 , 3226.5686786710903 ,
 1.3943171501159668 , 2435.881421821503 ,
 1.9888139963150024 , 1619.4310989900537 ,
 1.4413912296295166 , 1781.1124660218861 ,
 1.3367505073547363 , 909.9786904987839 ,
 1.643153190612793 , 1647.7160288358423 ,
 1.5638257265090942 , 2214.9283246902373 ,
 1.4169741868972778 , 961.2123623686913 ,
 2.1619553565979004 , 2080.8019087567554 ,
 1.5663706064224243 , 2606.051389010796 ,
 1.1871790885925293 , 894.0290873626019 ,
 1.4331233501434326 , 1197.8014092999938 ,
 1.192270040512085 , 1613.029813283592 ,
 1.6046063899993896 , 4527.359357785411 ,
 1.4919284582138062 , 4469.000170890629 ,
 1.5599013566970825 , 2612.3242220756447 ,
 1.4476550817489624 , 4403.955161444341 ,
 1.5147901773452759 , 4008.49778026771 ,
 1.4100980758666992 , 1181.8370288941724 ,
 1.3908538818359375 , 2601.555956366192 ,
 1.313908576965332 , 1098.2716033356319 ,
 1.1978075504302979 , 1537.2709554865862 ,
 1.464576005935669 , 767.7946643489133 ,
 1.4637858867645264 , 4762.946452213024 ,
 1.6298869848251343 , 3758.5956289571186 ,
 1.5618553161621094 , 2002.971981327932 ,
 1.4924784898757935 , 1861.0424860078224 ,
 1.4590541124343872 , 2407.0853377564345 ,
 1.3798362016677856 , 4786.483477172508 ,
 2.3812644481658936 , 2052.9720566065826 ,
 1.236365556716919 , 2972.5620557400657 ,
 1.2913068532943726 , 2247.0012619607833 ,
 1.3498225212097168 , 1548.3821649700683 ,
 1.458665132522583 , 3043.955125072298 ,
 1.4566925764083862 , 1248.14562682456 ,
 1.4257036447525024 , 1515.5282964991507 ,
 1.5496851205825806 , 2522.769127990826 ,
 1.6494992971420288 , 4210.471621269335 ,
 1.3796387910842896 , 858.5683108606023 ,
 1.4194093942642212 , 2242.2511677511766 ,
 1.447922706604004 , 2130.314333886632 ,
 1.379467487335205 , 929.38811815152 ,
 1.2433321475982666 , 1881.3072942773385 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Reach-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()

returns = []
path = './data/push-v2'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 52.420921325683594 , 73.78874113466533 ,
 25.221759796142578 , 23.728925303723095 ,
 86.55220794677734 , 961.481649655873 ,
 41.67774200439453 , 149.52191386687545 ,
 71.35663604736328 , 98.14758095857661 ,
 54.80427551269531 , 139.11685265198463 ,
 16.02279281616211 , 622.0154194305409 ,
 46.922607421875 , 283.5587768548628 ,
 25.939821243286133 , 371.4327009287945 ,
 128.2727508544922 , 114.43885346406623 ,
 49.536155700683594 , 47.66714772023403 ,
 119.59403991699219 , 31.587183835727593 ,
 82.0447998046875 , 318.9510527840947 ,
 33.596717834472656 , 130.53800134482788 ,
 60.227294921875 , 86.40632153483176 ,
 136.6107177734375 , 67.93702187963842 ,
 31.704355239868164 , 24.446320363201664 ,
 34.272823333740234 , 213.55090585178542 ,
 46.26387023925781 , 52.78359687442168 ,
 25.492916107177734 , 86.41012866642708 ,
 19.81376838684082 , 26.025280314657365 ,
 17.412086486816406 , 2653.3988634920725 ,
 45.05118942260742 , 31.08400496689199 ,
 65.11859130859375 , 117.36789102463774 ,
 13.556816101074219 , 160.52629817102593 ,
 52.927825927734375 , 310.70689590709117 ,
 14.718057632446289 , 52.49684772810805 ,
 112.3964614868164 , 163.86596366480137 ,
 5.579408645629883 , 55.3498605772682 ,
 59.878482818603516 , 4031.979657316263 ,
 32.42317199707031 , 34.226054311432335 ,
 8.797791481018066 , 30.13663977116065 ,
 58.55976104736328 , 164.32670992130727 ,
 20.8143310546875 , 108.99565609421278 ,
 58.18614959716797 , 66.10569780001961 ,
 5.139261245727539 , 25.77084166406188 ,
 34.65256881713867 , 76.00941077400806 ,
 48.681617736816406 , 732.5794550821083 ,
 0.11320531368255615 , 4563.442297763113 ,
 5.263219833374023 , 23.975381039634676 ,
 44.80220031738281 , 395.7401761023093 ,
 63.931358337402344 , 176.1609106438286 ,
 58.7844352722168 , 257.2066280307488 ,
 37.05698776245117 , 122.14448619413044 ,
 0.8183916807174683 , 3103.3577655228146 ,
 24.201210021972656 , 123.06523877593871 ,
 2.9680933952331543 , 3906.979790724773 ,
 21.12438201904297 , 134.9687708635466 ,
 36.243717193603516 , 130.78302313736572 ,
 72.39132690429688 , 46.9794389724594 ,
 13.861368179321289 , 1642.7950499335811 ,
 5.636817932128906 , 87.96163411986848 ,
 42.56340026855469 , 327.56584700191877 ,
 6.543558120727539 , 25.372724530822072 ,
 31.681671142578125 , 67.49198200380593 ,
 35.18631362915039 , 24.22793014585 ,
 61.554054260253906 , 64.44913886246596 ,
 7.98638391494751 , 25.175261799411185 ,
 12.239633560180664 , 69.20775008241216 ,
 5.565981864929199 , 26.217666981853167 ,
 64.64794921875 , 66.97066430724749 ,
 36.499794006347656 , 275.2700878954398 ,
 54.14164733886719 , 102.68905176183189 ,
 81.31595611572266 , 89.77823358313614 ,
 40.00426483154297 , 61.125044716647636 ,
 25.209083557128906 , 27.169095208104928 ,
 31.439979553222656 , 61.76473225502956 ,
 2.9203009605407715 , 951.5894662385738 ,
 3.341170310974121 , 90.8595997696788 ,
 40.8555908203125 , 256.878020155626 ,
 0.192204087972641 , 4665.385460009993 ,
 39.522708892822266 , 79.2002895996186 ,
 4.731130123138428 , 3680.47212247129 ,
 14.942316055297852 , 25.391627871333117 ,
 8.05905532836914 , 24.50439274902027 ,
 19.651546478271484 , 240.43810560278757 ,
 57.464012145996094 , 26.468863364850556 ,
 28.379533767700195 , 679.0704340643354 ,
 5.628830432891846 , 2337.5373206739223 ,
 73.79537963867188 , 162.08643544656343 ,
 57.69282150268555 , 517.68888956974 ,
 13.248384475708008 , 75.47276917411727 ,
 12.83355712890625 , 2901.4032305920223 ,
 72.48875427246094 , 301.3713532881716 ,
 9.837937355041504 , 2269.1380789907203 ,
 43.040916442871094 , 126.12354119501387 ,
 22.779705047607422 , 165.56740532497483 ,
 49.494083404541016 , 307.93959080809043 ,
 32.38368606567383 , 329.18434151809623 ,
 20.294960021972656 , 264.09957344248676 ,
 62.625160217285156 , 99.72014092850868 ,
 24.078441619873047 , 23.579925219508645 ,
 149.88832092285156 , 91.55062676427463 ,
 10.324195861816406 , 95.67985394137548 ,
 19.060062408447266 , 102.55015669581813 ,
 48.21761703491211 , 176.53784633966657 ,
 17.487804412841797 , 2645.640069746284 ,
 114.94305419921875 , 97.24189770041704 ,
 50.248878479003906 , 145.15644259266713 ,
 51.5560302734375 , 199.86894232510764 ,
 48.654659271240234 , 22.821108885311734 ,
 86.65536499023438 , 171.8583405570531 ,
 55.107784271240234 , 627.7169706177284 ,
 52.39368438720703 , 91.37707546709925 ,
 21.865930557250977 , 103.75119338765683 ,
 19.900108337402344 , 519.549092586271 ,
 13.16749095916748 , 2240.5485625555266 ,
 74.32579040527344 , 293.71028574192496 ,
 60.26737976074219 , 332.63654815943426 ,
 9.16470718383789 , 998.4637228727684 ,
 34.06317901611328 , 29.990416068370603 ,
 14.167600631713867 , 97.33123555035894 ,
 19.078405380249023 , 155.27728689261193 ,
 56.35540771484375 , 60.802321543483856 ,
 28.999908447265625 , 31.718757972883086 ,
 32.343101501464844 , 312.55652757320576 ,
 29.23972511291504 , 113.2904382033496 ,
 73.47604370117188 , 118.33183282527008 ,
 73.1015853881836 , 113.96638692787903 ,
 61.78797912597656 , 33.85976612975152 ,
 40.26561737060547 , 380.2317801220638 ,
 70.86143493652344 , 534.261591553382 ,
 2.571906566619873 , 26.868186215151187 ,
 93.04801940917969 , 31.061674141653345 ,
 41.54649353027344 , 283.2338659492958 ,
 94.31912231445312 , 317.2260736800082 ,
 5.201263427734375 , 2451.747876288081 ,
 55.75932312011719 , 1099.2669460552306 ,
 58.67742919921875 , 209.7266991736792 ,
 29.610633850097656 , 354.8759756273072 ,
 135.8255157470703 , 23.11092253123578 ,
 7.026446342468262 , 34.896569694694364 ,
 253.1261444091797 , 100.74529970806087 ,
 21.77252197265625 , 127.3686926866796 ,
 7.965147495269775 , 25.56551026075757 ,
 39.78511047363281 , 81.73696238910912 ,
 7.430613994598389 , 2719.8129348020334 ,
 59.45301055908203 , 433.03378158123587 ,
 0.27690088748931885 , 4619.923920739951 ,
 33.954734802246094 , 23.321626486883773 ,
 3.8028013706207275 , 3880.302371119277 ,
 14.585588455200195 , 192.1974176595165 ,
 14.376900672912598 , 268.2294904985596 ,
 17.97848129272461 , 329.667806673942 ,
 52.12002182006836 , 412.0375060158407 ,
 14.167800903320312 , 49.62206588789339 ,
 39.84089279174805 , 266.0232955738109 ,
 36.13992691040039 , 178.49597721763953 ,
 27.306636810302734 , 209.62186293054276 ,
 36.818477630615234 , 930.4603482818252 ,
 57.00124740600586 , 139.6223731637818 ,
 46.22850799560547 , 158.0755314033375 ,
 53.03395462036133 , 278.307160101328 ,
 57.18016052246094 , 221.27876912110224 ,
 15.857223510742188 , 506.2359794175097 ,
 2.306471109390259 , 21.459435585374475 ,
 35.527862548828125 , 277.9448308272315 ,
 22.432998657226562 , 54.76291382662458 ,
 11.735189437866211 , 38.992721824726864 ,
 61.44309997558594 , 94.4429247454697 ,
 21.808500289916992 , 24.329126981400197 ,
 18.404125213623047 , 403.0627413592521 ,
 36.87770462036133 , 231.7654197920005 ,
 74.47473907470703 , 215.60392690290294 ,
 103.03961944580078 , 276.73129117087564 ,
 8.40452766418457 , 3267.9711954771146 ,
 3.5440895557403564 , 307.15377859880925 ,
 28.87076187133789 , 132.03131969297053 ,
 25.92361831665039 , 162.31842125697545 ,
 17.454790115356445 , 913.8645725327459 ,
 1.0675609111785889 , 4193.7607217463765 ,
 1.0990359783172607 , 2252.672402661031 ,
 16.676082611083984 , 323.78754118484346 ,
 40.150978088378906 , 89.50584682683365 ,
 79.37528228759766 , 74.75232534415977 ,
 43.48365783691406 , 64.72997426786493 ,
 12.064979553222656 , 125.28009998395456 ,
 139.45974731445312 , 41.38559539329349 ,
 62.16242218017578 , 125.77176879605241 ,
 1.7733471393585205 , 3611.437153666702 ,
 67.83071899414062 , 66.47358969893298 ,
 8.202984809875488 , 2553.6952866299507 ,
 42.9163818359375 , 24.169008190075143 ,
 44.01348876953125 , 87.57876641830725 ,
 0.10141192376613617 , 4602.57518182535 ,
 16.32601547241211 , 2876.190923759193 ,
 10.669529914855957 , 3819.859512735129 ,
 23.26407814025879 , 2372.7661590328753 ,
 3.489565134048462 , 331.6389849245621 ,
 30.02873420715332 , 52.10857549628144 ,
 57.40094757080078 , 374.6838700592042 ,
 56.7619743347168 , 306.02042980166624 ,
 7.556079864501953 , 30.266979418263748 ,
 74.88616180419922 , 170.81838566575178 ,
 14.327245712280273 , 157.67324721096682 ,
 21.808500289916992 , 24.329126981400197 ,
 57.47468185424805 , 227.25400316317928 ,
 62.6226921081543 , 193.7692303601442 ,
 51.84442901611328 , 142.59423874296306 ,
 33.32225036621094 , 245.5949503975141 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Push-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 4.816032409667969 , 82.0581938160094 ,
 2.286972761154175 , 23.606362918006678 ,
 2.7063798904418945 , 27.931239703071775 ,
 0.9538664221763611 , 27.32375520203571 ,
 2.4789819717407227 , 159.60433655923669 ,
 1.918041467666626 , 371.206802224413 ,
 1.5489765405654907 , 52.322742369861984 ,
 5.709908962249756 , 111.2636893122442 ,
 1.6111925840377808 , 286.9828303290137 ,
 3.1792056560516357 , 147.9598019548838 ,
 2.643747329711914 , 4274.337471137297 ,
 2.2121798992156982 , 26.825089057414242 ,
 2.4367833137512207 , 2890.4437430419734 ,
 2.126110076904297 , 32.84878153036226 ,
 2.6484627723693848 , 258.72288491622055 ,
 1.927017331123352 , 151.31708125351835 ,
 1.7798101902008057 , 24.527124303190426 ,
 2.6460156440734863 , 66.87375889784926 ,
 2.1595542430877686 , 90.58111250465981 ,
 3.2518832683563232 , 169.72019067564796 ,
 2.7448325157165527 , 72.52671575757299 ,
 1.6845502853393555 , 72.07869956285577 ,
 2.033433437347412 , 284.1214596849834 ,
 3.767336845397949 , 74.44689561896332 ,
 3.0260417461395264 , 36.64739525028058 ,
 4.533794403076172 , 103.07450766368403 ,
 5.119377136230469 , 85.54424253220613 ,
 2.7923669815063477 , 4069.1110716203743 ,
 2.5082924365997314 , 4436.217765503869 ,
 2.538646936416626 , 312.0450379901656 ,
 5.11223030090332 , 50.115144283229164 ,
 3.4915947914123535 , 40.36342570855247 ,
 3.047196865081787 , 57.96083412565439 ,
 1.1444849967956543 , 122.65593444780026 ,
 1.9069055318832397 , 33.36092396699749 ,
 2.423927068710327 , 4585.801575075515 ,
 5.691041946411133 , 108.19231105712578 ,
 1.462558388710022 , 26.44146715164959 ,
 1.7232967615127563 , 68.11000226676876 ,
 2.619767665863037 , 320.9954886174227 ,
 3.6202445030212402 , 62.80270935598017 ,
 3.5198187828063965 , 428.6609102327809 ,
 2.5550642013549805 , 3485.658610748304 ,
 2.6599984169006348 , 4490.234020895601 ,
 3.612563133239746 , 161.27790857635665 ,
 2.100593328475952 , 1084.019370135855 ,
 1.2694398164749146 , 44.36431667302804 ,
 2.6638147830963135 , 25.23896110760519 ,
 3.345214366912842 , 118.59169654709714 ,
 2.540851354598999 , 4027.224867891877 ,
 1.2489464282989502 , 89.88324571253548 ,
 3.562364101409912 , 173.7103154235027 ,
 3.6891212463378906 , 25.346826188610354 ,
 1.4631550312042236 , 24.380660365288932 ,
 1.3449585437774658 , 3224.7955954893214 ,
 1.1317750215530396 , 64.67674465721666 ,
 2.2850303649902344 , 958.7852082973754 ,
 1.5386227369308472 , 23.246115730331304 ,
 3.747403144836426 , 78.99089791980597 ,
 1.6928551197052002 , 25.71975981740474 ,
 6.50954008102417 , 66.97066430724749 ,
 2.093782901763916 , 379.94633068631146 ,
 3.5431759357452393 , 135.86812117307844 ,
 4.103983402252197 , 72.25846025632711 ,
 4.2116241455078125 , 3799.593304415055 ,
 2.707810163497925 , 4256.70688577319 ,
 2.6998343467712402 , 80.18290518664081 ,
 2.666037082672119 , 1925.5756099419064 ,
 3.8205599784851074 , 96.95295512579156 ,
 1.2701876163482666 , 25.537110358711903 ,
 2.0649445056915283 , 409.4343187378006 ,
 2.3051531314849854 , 4562.714670144183 ,
 3.6410348415374756 , 79.26498257123076 ,
 1.1647710800170898 , 124.18004487410481 ,
 1.9399114847183228 , 210.50697535247298 ,
 2.7230801582336426 , 156.32877739684386 ,
 3.3785178661346436 , 198.81626748012366 ,
 2.720560073852539 , 163.02918420970104 ,
 2.1939072608947754 , 438.9228153078502 ,
 2.5907514095306396 , 106.326172724732 ,
 2.3780550956726074 , 517.68888956974 ,
 3.034275770187378 , 305.15699818101206 ,
 2.5667097568511963 , 68.72159285020737 ,
 2.1356794834136963 , 241.91735974689394 ,
 3.715883255004883 , 132.68682137107686 ,
 2.6801671981811523 , 26.125078526512986 ,
 4.540114879608154 , 58.90748655684898 ,
 2.150737762451172 , 242.3726631246147 ,
 3.9838757514953613 , 224.78144286451464 ,
 2.644120216369629 , 4525.369308679528 ,
 3.114604949951172 , 62.31970517100298 ,
 1.824139952659607 , 23.123517868278288 ,
 3.251448631286621 , 311.0924363707836 ,
 2.8732235431671143 , 209.73360309567897 ,
 2.112891674041748 , 89.01584416467739 ,
 4.514644145965576 , 82.55587603807938 ,
 2.379141092300415 , 2644.353188526784 ,
 6.667595386505127 , 37.04476439310797 ,
 2.775114059448242 , 61.07829269088762 ,
 3.029207468032837 , 79.4114265006823 ,
 2.410857915878296 , 1894.738576393346 ,
 5.728794097900391 , 1583.0475285078342 ,
 2.54592227935791 , 24.31575910602818 ,
 0.9777740240097046 , 30.518246659097812 ,
 2.8117339611053467 , 81.31473744827338 ,
 1.2271963357925415 , 376.7850249625475 ,
 3.3660924434661865 , 578.6220339631109 ,
 1.921047329902649 , 298.14024877019466 ,
 2.162609100341797 , 4649.219350821797 ,
 4.051411151885986 , 362.9545185854937 ,
 1.79533851146698 , 27.08948698995645 ,
 2.0036492347717285 , 4548.592753256421 ,
 0.7986542582511902 , 31.172859446107626 ,
 2.64866304397583 , 259.61896978823506 ,
 3.8175766468048096 , 71.91564333300235 ,
 1.5462746620178223 , 291.0915796653458 ,
 2.3029870986938477 , 96.31274693085646 ,
 2.381669282913208 , 504.7007363966357 ,
 1.6943588256835938 , 28.52073478775042 ,
 1.2650744915008545 , 277.8786700949979 ,
 1.0425496101379395 , 26.865403169942162 ,
 6.093600749969482 , 118.39262029266371 ,
 2.994276285171509 , 292.91417553979363 ,
 2.1975741386413574 , 27.066204103780894 ,
 3.413092613220215 , 247.35188197069013 ,
 4.292870044708252 , 408.59642128917494 ,
 2.2416505813598633 , 2018.5194956228738 ,
 1.4819226264953613 , 215.3662420791361 ,
 2.493398427963257 , 126.9224271751596 ,
 5.392279624938965 , 56.93198536553204 ,
 2.0886032581329346 , 21.803074980650603 ,
 1.664992332458496 , 31.101752913784438 ,
 1.8356856107711792 , 21.969929044244523 ,
 2.5056753158569336 , 4016.232390134078 ,
 1.382171630859375 , 29.027928815937663 ,
 1.165432095527649 , 340.525622570353 ,
 2.3135898113250732 , 4622.834921216534 ,
 2.1664700508117676 , 135.89797129700167 ,
 3.5611636638641357 , 47.84739566657631 ,
 1.663723111152649 , 454.5885640148771 ,
 5.772871971130371 , 32.93297001552866 ,
 3.049931526184082 , 4459.882252955562 ,
 1.1658607721328735 , 211.72493135632476 ,
 1.3346562385559082 , 188.474078203854 ,
 2.226925849914551 , 3322.98265124225 ,
 3.1963462829589844 , 179.24069273862443 ,
 0.9730031490325928 , 192.5454180166114 ,
 3.9344937801361084 , 155.80049118458726 ,
 2.631863594055176 , 3322.248379872679 ,
 2.590348482131958 , 256.5881351463089 ,
 3.552241802215576 , 72.75255777592082 ,
 2.4066596031188965 , 349.1114913783333 ,
 2.304919719696045 , 4495.358139737113 ,
 3.911802053451538 , 67.29745374143369 ,
 5.142807483673096 , 76.93279200740857 ,
 4.521914482116699 , 88.30162280047774 ,
 0.8631387948989868 , 31.00082241294975 ,
 2.2159807682037354 , 207.99378756622514 ,
 2.4589250087738037 , 29.334857113627578 ,
 2.4746623039245605 , 173.51178086292137 ,
 2.268131732940674 , 413.85842326251463 ,
 1.459969401359558 , 23.15205359711801 ,
 4.499299049377441 , 146.0206633133485 ,
 1.650895118713379 , 125.62649230213441 ,
 1.3273507356643677 , 381.7667601302585 ,
 2.27323055267334 , 1816.6035848328982 ,
 2.1996288299560547 , 4366.569153990229 ,
 2.1664931774139404 , 3006.893393590055 ,
 2.5216000080108643 , 24.32300409707283 ,
 3.8101887702941895 , 71.93992700005919 ,
 2.677917718887329 , 62.629535696848265 ,
 1.7225652933120728 , 34.36056103164742 ,
 3.0160422325134277 , 332.00752382801534 ,
 1.371058464050293 , 155.1375830171899 ,
 3.4086527824401855 , 173.45013646226033 ,
 3.0369346141815186 , 74.65108879199214 ,
 1.5430647134780884 , 90.70632354397978 ,
 3.6548044681549072 , 549.292841869456 ,
 1.529491662979126 , 173.96246039442798 ,
 1.9773497581481934 , 99.69555645781887 ,
 2.307990312576294 , 32.09732674005514 ,
 1.7199214696884155 , 101.25978012815946 ,
 0.9482594728469849 , 66.93895848991954 ,
 1.3229749202728271 , 224.73158145368785 ,
 2.2180263996124268 , 24.181069801821724 ,
 2.2114946842193604 , 54.1953608369723 ,
 1.2730169296264648 , 304.0849009472746 ,
 2.095130681991577 , 896.1145745211734 ,
 3.509873151779175 , 58.80809369126507 ,
 2.1576013565063477 , 3957.026467384987 ,
 1.5949980020523071 , 295.097281594385 ,
 2.3622870445251465 , 1123.7549450525744 ,
 4.712616920471191 , 220.56517418461385 ,
 0.8520463705062866 , 386.583645775194 ,
 3.3647801876068115 , 398.04179225986263 ,
 1.3530081510543823 , 318.147677037417 ,
 1.4569183588027954 , 23.140519649337712 ,
 2.3702478408813477 , 94.38349297601987 ,
 3.1537575721740723 , 231.58805308744775 ,
 0.8463342785835266 , 36.15577491297792 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Push-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()




returns = []
path = './data/soccer-v2'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 0.8238351345062256 , 1054.1574304067185 ,
 8.025811195373535 , 2061.2142238636097 ,
 0.4999876022338867 , 180.24468585015822 ,
 5.136194705963135 , 1428.2628135897914 ,
 4.544713497161865 , 1595.7367978212217 ,
 0.44284313917160034 , 137.32994378032174 ,
 1.701590895652771 , 591.2390256982453 ,
 2.063141107559204 , 20.79026327904556 ,
 15.823341369628906 , 1913.7487202240764 ,
 0.9981113076210022 , 161.72603119011467 ,
 11.700002670288086 , 767.7230910683647 ,
 1.6793415546417236 , 169.17537238447278 ,
 4.398743629455566 , 1232.6903321551858 ,
 0.4892129898071289 , 26.96901397949612 ,
 2.306227207183838 , 141.91048577729606 ,
 3.3923511505126953 , 71.66975326461234 ,
 10.935428619384766 , 1810.3528729351542 ,
 0.3333298861980438 , 19.082418724336428 ,
 0.4654694199562073 , 109.80907647947636 ,
 0.9254382252693176 , 276.1165787285301 ,
 0.10238370299339294 , 339.67344840808687 ,
 5.706121444702148 , 134.3593136715403 ,
 5.779674053192139 , 136.7337570964362 ,
 0.3008895516395569 , 108.24950165557826 ,
 1.800523042678833 , 51.925944428514384 ,
 0.5767809152603149 , 22.615028559817354 ,
 6.764505386352539 , 1506.902706415865 ,
 17.53619956970215 , 77.02325802287831 ,
 0.21425102651119232 , 429.299632930004 ,
 2.40757155418396 , 1756.4806288792292 ,
 1.2606053352355957 , 4104.188099358089 ,
 1.335616946220398 , 359.0551720523272 ,
 0.321163147687912 , 24.521705890672123 ,
 0.24560749530792236 , 22.20418820476477 ,
 1.5079623460769653 , 221.3131741696671 ,
 0.8918246030807495 , 210.26499116627 ,
 0.8616529107093811 , 310.0867502276021 ,
 0.2573983371257782 , 318.00988290859857 ,
 0.18252846598625183 , 257.5564271158486 ,
 43.21658706665039 , 3888.8991255619085 ,
 1.9149460792541504 , 20.444397524242852 ,
 0.18406404554843903 , 268.97713963439094 ,
 1.017516016960144 , 979.7690438087691 ,
 13.898300170898438 , 454.9891875141542 ,
 7.544267654418945 , 1684.8759041284684 ,
 1.3903172016143799 , 442.9646891590554 ,
 0.49093976616859436 , 166.38145191640632 ,
 2.1284329891204834 , 26.714764355969752 ,
 5.887983322143555 , 434.98414631022536 ,
 5.807353973388672 , 90.53823579474215 ,
 0.12670697271823883 , 29.028058188344936 ,
 11.702359199523926 , 53.92148328584102 ,
 3.817136526107788 , 161.71252433584044 ,
 0.8697482347488403 , 67.08688370573837 ,
 21.624164581298828 , 1375.6546867732534 ,
 38.710784912109375 , 115.10178254069422 ,
 1.867501139640808 , 58.81792772455352 ,
 8.169434547424316 , 349.34909113443973 ,
 3.7313170433044434 , 891.1268359781151 ,
 0.827266275882721 , 27.01252071174354 ,
 0.877307653427124 , 342.4933458316639 ,
 3.511121988296509 , 25.836471016036988 ,
 1.6450939178466797 , 359.98145604755683 ,
 1.9327392578125 , 538.3085788695282 ,
 1.7990872859954834 , 155.39936636174411 ,
 0.8570635318756104 , 790.6338447335932 ,
 0.6500329971313477 , 353.83637960119654 ,
 1.0186436176300049 , 430.0874603791081 ,
 0.24365440011024475 , 357.89220549048116 ,
 1.1653006076812744 , 15.680299159520123 ,
 0.7480838894844055 , 181.42596758034628 ,
 15.159464836120605 , 791.2068811991471 ,
 0.2945866584777832 , 174.26610581924848 ,
 0.4756861925125122 , 22.243704530218626 ,
 0.23591724038124084 , 253.09907231788915 ,
 0.633594274520874 , 182.15989095454586 ,
 0.21399974822998047 , 31.5525495232856 ,
 0.5493589043617249 , 24.593408494250454 ,
 6.32371711730957 , 3009.1125103319064 ,
 5.359915733337402 , 1505.6043462704315 ,
 3.185255289077759 , 2413.685168972694 ,
 3.0422534942626953 , 215.07282220345965 ,
 0.27293336391448975 , 136.31512442691914 ,
 2.4819765090942383 , 33.14764403619339 ,
 6.826690673828125 , 74.22002194840638 ,
 2.3931946754455566 , 143.20472084617649 ,
 0.2049284130334854 , 271.77245766388467 ,
 3.1117331981658936 , 465.37573592683617 ,
 0.8248631954193115 , 266.46119618164596 ,
 0.2028268724679947 , 20.940986759341335 ,
 0.8533607125282288 , 355.2355002509287 ,
 39.87091827392578 , 3092.054781133907 ,
 0.31289228796958923 , 184.30392138114445 ,
 1.536678671836853 , 46.62391179122468 ,
 0.21673370897769928 , 486.5108043937201 ,
 0.19139918684959412 , 22.096111871212162 ,
 10.771074295043945 , 514.7277293794361 ,
 8.648895263671875 , 219.27142579574948 ,
 0.7059943079948425 , 236.7781600430693 ,
 6.093737602233887 , 26.438772701402605 ,
 16.052642822265625 , 684.3438573788225 ,
 3.759775161743164 , 416.97794146641843 ,
 2.193307876586914 , 281.16930564836 ,
 0.311788409948349 , 21.864386005482906 ,
 14.568262100219727 , 3846.2693957350643 ,
 1.065616488456726 , 867.3350377559397 ,
 0.3579860031604767 , 82.68068257651082 ,
 0.47460514307022095 , 20.570655677864075 ,
 12.172752380371094 , 457.0540891458744 ,
 0.33111003041267395 , 154.720220582345 ,
 7.575881004333496 , 26.225569971890856 ,
 4.086514949798584 , 279.8738887681847 ,
 0.33205974102020264 , 227.32488326575753 ,
 0.29391586780548096 , 38.720610082158814 ,
 8.920194625854492 , 761.6237221160244 ,
 0.4789389371871948 , 570.4314595904418 ,
 4.1095356941223145 , 269.9647107725799 ,
 13.545190811157227 , 132.8260861205585 ,
 3.0532913208007812 , 24.786948506524112 ,
 5.817548751831055 , 264.9155693474275 ,
 0.24804039299488068 , 615.3177229961443 ,
 10.270246505737305 , 31.719477064313587 ,
 4.309318542480469 , 193.5034157527769 ,
 9.646247863769531 , 88.22076979357685 ,
 36.89193344116211 , 65.68496205803362 ,
 4.093959808349609 , 1279.5059138373992 ,
 0.8759716153144836 , 453.02709753835677 ,
 0.1130281314253807 , 23.146650074672188 ,
 5.651886940002441 , 1522.8851427059194 ,
 0.87331622838974 , 153.33289984909163 ,
 0.8127846717834473 , 340.5562679305167 ,
 1.3526124954223633 , 237.1793456949654 ,
 18.037952423095703 , 26.478094895729484 ,
 19.570842742919922 , 27.636589618559647 ,
 0.179167702794075 , 21.747385205769326 ,
 15.735040664672852 , 2032.12097168208 ,
 1.0982191562652588 , 31.072979322558254 ,
 0.724542498588562 , 21.092121459809793 ,
 4.368527412414551 , 1180.5280190288327 ,
 0.16009822487831116 , 22.238249540390836 ,
 0.1597096025943756 , 277.113236853479 ,
 0.9336298704147339 , 340.43050919097175 ,
 0.5768925547599792 , 23.982589244429175 ,
 40.74932861328125 , 29.321916014700353 ,
 1.4368466138839722 , 43.05484100040588 ,
 0.20286116003990173 , 278.73969290547456 ,
 56.45912551879883 , 28.499484518449165 ,
 0.7487245202064514 , 2149.7652744668267 ,
 0.6415748596191406 , 224.9296114263012 ,
 0.6349996328353882 , 447.7545267018496 ,
 18.249679565429688 , 2260.8153357704778 ,
 10.057823181152344 , 119.28294825665509 ,
 0.2445240616798401 , 116.60419882799732 ,
 0.48898234963417053 , 25.400030018176338 ,
 28.809406280517578 , 20.719648791714775 ,
 0.9868874549865723 , 24.68326682021823 ,
 0.2860985994338989 , 98.12208591407645 ,
 1.6965715885162354 , 256.74441084590444 ,
 0.45410990715026855 , 577.8661328669608 ,
 0.878302812576294 , 234.36339857164563 ,
 1.6271042823791504 , 9.016540481114014 ,
 0.5262821316719055 , 14.234916879057447 ,
 29.575313568115234 , 95.33135978998293 ,
 0.07799822092056274 , 522.8271405516878 ,
 3.493495225906372 , 3187.7714947442 ,
 47.01199722290039 , 28.231894893216676 ,
 0.42173027992248535 , 66.92391936222623 ,
 16.147071838378906 , 266.108070530333 ,
 0.3015803098678589 , 31.220992417569835 ,
 1.7531847953796387 , 769.006059118451 ,
 3.543551206588745 , 25.668486784103052 ,
 6.386486053466797 , 1325.7888416002374 ,
 0.34956228733062744 , 22.935511704302634 ,
 2.6815884113311768 , 1516.2277261700865 ,
 18.468103408813477 , 1590.105212469427 ,
 0.17863574624061584 , 214.09015670184522 ,
 0.6015732884407043 , 221.20484004475867 ,
 3.94454288482666 , 98.3857905648456 ,
 0.2071138322353363 , 219.46764375466805 ,
 31.224451065063477 , 25.993993067562954 ,
 0.7334753274917603 , 142.16513741464516 ,
 28.549171447753906 , 37.778777549592924 ,
 9.50234603881836 , 1543.3297476670275 ,
 0.46997928619384766 , 133.17460909316708 ,
 2.9336979389190674 , 109.39318126806 ,
 0.34020358324050903 , 286.30246008380686 ,
 1.7389463186264038 , 26.976170614049618 ,
 0.6817809343338013 , 13.151725350382684 ,
 2.184596538543701 , 1543.9949859085564 ,
 10.546390533447266 , 328.1143574345724 ,
 8.669109344482422 , 158.81734079784908 ,
 0.599801242351532 , 21.174695578969775 ,
 0.41016435623168945 , 85.28147118780986 ,
 0.4170590937137604 , 27.010674403059824 ,
 11.496177673339844 , 115.628288141861 ,
 0.6670231819152832 , 89.28326487420004 ,
 0.4248370826244354 , 106.57464724877377 ,
 16.973834991455078 , 69.45373501950733 ,
 0.2836436629295349 , 540.950718069006 ,
 0.16706234216690063 , 244.51009961647068 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Soccer-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 1.9703673124313354 , 24.68824450636 ,
 0.8523748517036438 , 338.0419409848416 ,
 1.646578311920166 , 2564.2525291596376 ,
 0.5444779396057129 , 28.91470216620091 ,
 0.6753467321395874 , 304.49097366309616 ,
 0.7950448989868164 , 88.02428209117156 ,
 1.8593289852142334 , 2796.716796160403 ,
 0.8371562957763672 , 251.2937796566842 ,
 1.5319793224334717 , 112.91442481533028 ,
 0.11264609545469284 , 22.772936049880578 ,
 0.35716331005096436 , 523.8009880885586 ,
 0.7397432923316956 , 220.47334329342726 ,
 0.7399429082870483 , 26.112994912018287 ,
 0.619836151599884 , 217.2191372816755 ,
 1.380952000617981 , 322.44090021202635 ,
 0.8448478579521179 , 25.026008344468146 ,
 0.5245947241783142 , 25.115087818685602 ,
 1.521666407585144 , 445.1459708217034 ,
 1.0550791025161743 , 263.7894908437264 ,
 1.9884825944900513 , 1880.3859142044375 ,
 2.5846385955810547 , 436.1487160732006 ,
 0.41801032423973083 , 19.46662002705833 ,
 0.24140749871730804 , 15.603060304174186 ,
 1.7581669092178345 , 4151.171348759781 ,
 0.9719410538673401 , 45.96272772014942 ,
 0.8840835690498352 , 418.77458279486524 ,
 1.0574982166290283 , 2488.681149698859 ,
 1.352906584739685 , 99.22347005979888 ,
 0.20396599173545837 , 32.329165144214606 ,
 0.4762389063835144 , 436.355891220703 ,
 1.3161126375198364 , 25.205390533085076 ,
 0.08450042456388474 , 25.55896103466673 ,
 0.4663681983947754 , 236.97457754908504 ,
 1.142629623413086 , 289.0350051672755 ,
 2.9235918521881104 , 2093.4618111509562 ,
 1.1176830530166626 , 19.86318159835175 ,
 0.35179850459098816 , 217.37115538254764 ,
 1.4500151872634888 , 2372.759066305212 ,
 2.5821969509124756 , 1433.3547849506886 ,
 0.420217365026474 , 233.22940682909274 ,
 0.14766542613506317 , 23.789083639779633 ,
 0.4437791407108307 , 174.0400507050892 ,
 0.3832133710384369 , 1896.1432171967886 ,
 1.4033665657043457 , 536.3108270006444 ,
 0.3394870162010193 , 391.2439691958549 ,
 1.0332527160644531 , 153.1186901299071 ,
 0.6627424955368042 , 36.087933798376355 ,
 2.113511085510254 , 3748.949947691768 ,
 0.6839583516120911 , 3059.8402699265016 ,
 0.7965500950813293 , 470.9091511547787 ,
 0.4046012759208679 , 14.55026819783774 ,
 0.13578912615776062 , 25.62635472643352 ,
 0.8192433714866638 , 74.54031561574098 ,
 1.4539146423339844 , 1185.959084369233 ,
 1.6316208839416504 , 112.13920816870953 ,
 1.7423855066299438 , 1597.7422958088414 ,
 0.37907618284225464 , 210.56137032065317 ,
 0.3852001428604126 , 124.34658604457339 ,
 0.4518772065639496 , 111.77946581273736 ,
 0.8214958906173706 , 20.743695969585538 ,
 0.3650263547897339 , 110.4275844510884 ,
 0.5344333052635193 , 44.56047068133019 ,
 1.243744134902954 , 27.08983662978509 ,
 0.3081587255001068 , 235.245903815716 ,
 0.6693633794784546 , 501.5019841076962 ,
 0.10505169630050659 , 15.1085952380863 ,
 1.5443189144134521 , 108.41414543117469 ,
 0.3515675663948059 , 40.94204148518499 ,
 1.293515920639038 , 2244.026963976399 ,
 0.3672228753566742 , 42.89061059167432 ,
 0.36355555057525635 , 23.67314215295968 ,
 1.7175554037094116 , 1330.6865696069622 ,
 0.3883633017539978 , 791.1636581736284 ,
 0.7198958396911621 , 22.958289159026336 ,
 1.529203176498413 , 328.1033183732426 ,
 0.11902282387018204 , 24.546204181628823 ,
 0.49399304389953613 , 142.8902284788404 ,
 0.3341447710990906 , 261.0535258170381 ,
 0.5296761393547058 , 61.36806646988555 ,
 0.3419734239578247 , 73.2373686102263 ,
 0.39360326528549194 , 72.43671728540424 ,
 2.5041065216064453 , 221.46716072721125 ,
 1.4026654958724976 , 78.18191275851224 ,
 0.38093194365501404 , 250.57015532771405 ,
 0.448012113571167 , 233.86652385021563 ,
 0.11021459102630615 , 21.781072089745397 ,
 0.945349395275116 , 928.7464593816153 ,
 1.0546575784683228 , 240.20648420996898 ,
 1.0427489280700684 , 1913.901134632319 ,
 0.10547804087400436 , 13.239814536163081 ,
 0.9379563927650452 , 215.6327088307299 ,
 0.34783825278282166 , 129.94123536965043 ,
 0.31060075759887695 , 160.42827841085028 ,
 0.6530767679214478 , 59.88226046874725 ,
 0.42069587111473083 , 175.60989344374786 ,
 0.5224463939666748 , 26.344560904020614 ,
 0.6772973537445068 , 210.68381129439746 ,
 0.7909242510795593 , 94.05099694334473 ,
 0.9773423671722412 , 154.18931180249257 ,
 1.2868832349777222 , 28.873136120686773 ,
 1.2596009969711304 , 43.01033309916821 ,
 1.013789176940918 , 328.07679817160056 ,
 0.5356585383415222 , 25.745170620950756 ,
 0.7978766560554504 , 292.1794488513557 ,
 2.7210381031036377 , 1548.6308372793737 ,
 1.6305348873138428 , 564.957355034788 ,
 0.1955689638853073 , 15.85297520156091 ,
 0.33870622515678406 , 99.23412773018867 ,
 0.14494584500789642 , 18.157441965419835 ,
 0.5739938020706177 , 641.7774020614393 ,
 1.09284508228302 , 171.12437468093168 ,
 0.6349392533302307 , 369.2756926736398 ,
 2.816255569458008 , 1596.510111403693 ,
 1.4038879871368408 , 154.33935807291158 ,
 1.5060458183288574 , 29.146447986290006 ,
 2.878657341003418 , 1358.7673952282796 ,
 0.5303817391395569 , 455.57608475503946 ,
 0.16607242822647095 , 26.38309396232205 ,
 1.949339509010315 , 22.850860261204538 ,
 0.10271762311458588 , 22.11241693230784 ,
 0.9491308927536011 , 120.24933091930566 ,
 0.14953288435935974 , 16.282031853295152 ,
 0.32799839973449707 , 25.29522954878988 ,
 0.7894724607467651 , 156.24244440455917 ,
 0.2796131372451782 , 108.35337697934575 ,
 0.8313797116279602 , 234.8348225724477 ,
 0.368442177772522 , 432.95775076697845 ,
 0.5491155385971069 , 226.79143267740832 ,
 0.5426395535469055 , 20.970277536769046 ,
 0.4507085382938385 , 427.7630967243193 ,
 0.6306735277175903 , 30.567416639220248 ,
 1.0454038381576538 , 190.4754611546185 ,
 0.4841236174106598 , 3038.5641894436553 ,
 0.08498549461364746 , 24.14756072704909 ,
 0.33954912424087524 , 164.72796077754123 ,
 0.3843134641647339 , 340.47931332187983 ,
 0.4826582372188568 , 277.070860995691 ,
 0.23969629406929016 , 19.527649864657743 ,
 0.502776563167572 , 233.0483695155674 ,
 1.341345191001892 , 120.43568663883374 ,
 0.36955487728118896 , 2779.209885592708 ,
 0.10742941498756409 , 28.088304431679116 ,
 0.43139883875846863 , 39.29271885968701 ,
 1.3629720211029053 , 464.644289674294 ,
 1.0426558256149292 , 137.07515311764362 ,
 0.39741218090057373 , 303.5659507543816 ,
 0.47778618335723877 , 34.08762983102124 ,
 0.4154170751571655 , 133.58378843973182 ,
 1.6288543939590454 , 1193.7785152654906 ,
 1.4338080883026123 , 31.417505780043818 ,
 0.08958438038825989 , 19.06401327604689 ,
 0.48356863856315613 , 526.451294852347 ,
 1.0452303886413574 , 271.9990004009256 ,
 0.8441946506500244 , 219.28869409022414 ,
 0.3445141315460205 , 38.74925152860276 ,
 1.1245672702789307 , 10.87958425067374 ,
 1.537325382232666 , 161.8205195821345 ,
 1.33701753616333 , 285.8057893731492 ,
 2.1585683822631836 , 326.1024485954133 ,
 1.9630601406097412 , 1877.9570232420524 ,
 0.7514000535011292 , 296.61017119030805 ,
 0.5317777991294861 , 195.4122085673763 ,
 0.4050145745277405 , 320.64344395335377 ,
 0.454141765832901 , 209.4035773183833 ,
 0.4328739643096924 , 202.84626676918901 ,
 0.4763302206993103 , 16.167800692913463 ,
 2.018850326538086 , 2771.474673541098 ,
 0.463367760181427 , 75.99083662952307 ,
 0.09531616419553757 , 17.7858093934893 ,
 3.525357723236084 , 23.395572576609638 ,
 0.31769993901252747 , 34.92811380109269 ,
 0.4893699884414673 , 134.62506483486695 ,
 0.777181088924408 , 26.035993525808166 ,
 0.766849935054779 , 946.9121198512896 ,
 0.6528557538986206 , 395.36689367377164 ,
 0.48035117983818054 , 216.00514185980157 ,
 0.487201452255249 , 12.803718938552674 ,
 1.4863042831420898 , 172.21666761091979 ,
 1.4485793113708496 , 586.9426708667008 ,
 1.2403461933135986 , 30.47560411350613 ,
 0.8231804966926575 , 60.43496657472078 ,
 0.17713496088981628 , 17.826902176688474 ,
 0.17185987532138824 , 25.138566844801133 ,
 0.42536717653274536 , 221.63599070545416 ,
 0.1191752701997757 , 31.60130656510602 ,
 1.05940842628479 , 21.729597840711115 ,
 1.7999714612960815 , 648.1849093236285 ,
 2.0699942111968994 , 22.79337724440079 ,
 0.17203621566295624 , 14.657557838821068 ,
 0.5154011249542236 , 2095.473574414096 ,
 0.35979026556015015 , 225.6634091562118 ,
 0.39847517013549805 , 536.2748951428 ,
 1.891501545906067 , 2311.8661993791566 ,
 0.39545804262161255 , 286.3426611655039 ,
 1.2527728080749512 , 733.8522717825756 ,
 0.43558546900749207 , 25.871376129302845 ,
 0.4376680850982666 , 347.127678867738 ,
 0.5208748579025269 , 196.95480018900216 ,
 1.8595536947250366 , 141.3827037082473 ,
 0.5870034098625183 , 120.27125154801575 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Soccer-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()

returns = []
path = './data/drawer-close-v2'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 0.027737228199839592 , 4359.321042632063 ,
 0.21491390466690063 , 4356.9879561213675 ,
 83.68184661865234 , 4.651842807501701 ,
 1.0420844554901123 , 4169.257887729245 ,
 0.3374593257904053 , 4291.869915416542 ,
 0.08923893421888351 , 4344.541546389346 ,
 1.2668743133544922 , 4156.503195267816 ,
 1.229292631149292 , 4492.139437856624 ,
 0.2910047769546509 , 4285.73628837527 ,
 83.7569580078125 , 4.262896044926517 ,
 0.09765985608100891 , 4301.1300332714345 ,
 0.11627139151096344 , 4331.086076824004 ,
 0.7469773292541504 , 4221.087833647408 ,
 0.06608489155769348 , 4241.126887053591 ,
 0.08998044580221176 , 4331.132345910696 ,
 0.2771221995353699 , 4279.967953404343 ,
 4.49960470199585 , 4203.579897482136 ,
 0.08674518018960953 , 4372.26393443653 ,
 0.16291335225105286 , 4338.004724184177 ,
 0.08460188657045364 , 4276.080097165464 ,
 0.06418357789516449 , 4341.68533640261 ,
 0.2250816524028778 , 4311.4853175830885 ,
 0.08200881630182266 , 4241.431500075374 ,
 0.24353304505348206 , 4281.415019921653 ,
 0.13125848770141602 , 4251.454221146609 ,
 0.8161836862564087 , 4303.352621056632 ,
 83.73005676269531 , 5.284523263677126 ,
 0.2377721071243286 , 4306.5114053178395 ,
 0.06705533713102341 , 4368.01324647807 ,
 0.06867213547229767 , 4367.99268708257 ,
 1.4082077741622925 , 4162.351481346954 ,
 0.05859696865081787 , 4377.16593972785 ,
 0.9802933931350708 , 4257.061346286015 ,
 1.107529640197754 , 4178.93402863078 ,
 0.9511570930480957 , 4237.605456036688 ,
 1.1310733556747437 , 4212.539815092114 ,
 0.05984513461589813 , 4223.34570047606 ,
 2.121605634689331 , 4172.65058442794 ,
 0.1971844732761383 , 4303.5267286695735 ,
 0.10032174736261368 , 4272.828608858175 ,
 0.41793718934059143 , 4272.040289336824 ,
 6.954799652099609 , 4093.706267624762 ,
 0.0866779088973999 , 4290.86869724759 ,
 0.08065570890903473 , 4276.908300635867 ,
 0.15078431367874146 , 4340.985149907103 ,
 0.9127038717269897 , 4222.307253705514 ,
 0.21084973216056824 , 4293.115637818852 ,
 0.11692540347576141 , 4282.684249223163 ,
 1.8106980323791504 , 4192.387608452731 ,
 0.08479735255241394 , 4232.439346801512 ,
 84.90780639648438 , 3.5153968728048164 ,
 0.06366138905286789 , 4247.454101352394 ,
 0.42653465270996094 , 4277.261491259182 ,
 0.1447068452835083 , 4305.006366077874 ,
 0.2272956520318985 , 4217.055760783218 ,
 1.1462236642837524 , 4156.551910894651 ,
 0.10510081797838211 , 4352.192785068926 ,
 0.16037212312221527 , 4335.084973479276 ,
 0.2941000759601593 , 4385.335138995157 ,
 1.0944324731826782 , 4157.421206489954 ,
 0.17158114910125732 , 4271.0125823506605 ,
 0.5390506386756897 , 4240.9929411111 ,
 0.06066175550222397 , 4241.028691995332 ,
 0.1947946548461914 , 4341.164134165404 ,
 0.597326397895813 , 4291.0426730469735 ,
 0.9417173266410828 , 4222.637605955244 ,
 0.10243652760982513 , 4303.70106866927 ,
 0.2990959882736206 , 4274.895930469773 ,
 0.06823892146348953 , 4233.685868491141 ,
 2.918872356414795 , 4152.753228578623 ,
 0.08322832733392715 , 4342.025971980305 ,
 0.22378948330879211 , 4311.627222107269 ,
 0.0844900906085968 , 4241.566440619177 ,
 0.10454743355512619 , 4311.621124172847 ,
 0.19217796623706818 , 4271.536633608479 ,
 0.1912696659564972 , 4357.536154168663 ,
 6.7635016441345215 , 4202.866000922015 ,
 0.2588014304637909 , 4263.574834480066 ,
 0.25276222825050354 , 4274.344133448223 ,
 0.23061427474021912 , 4253.2802809855475 ,
 0.06195516139268875 , 4241.588669352427 ,
 0.25214529037475586 , 4311.629089677447 ,
 0.16917484998703003 , 4311.652557818377 ,
 1.268566608428955 , 4181.531015793784 ,
 0.2629238963127136 , 4281.550688056599 ,
 0.16054369509220123 , 4270.971364913601 ,
 0.12708637118339539 , 4300.967682237776 ,
 0.21373075246810913 , 4280.979702405073 ,
 0.07439766079187393 , 4240.980126778886 ,
 0.06250626593828201 , 4330.981168878839 ,
 0.22753341495990753 , 4301.849225311191 ,
 0.057160381227731705 , 4221.73051226935 ,
 1.8312690258026123 , 4191.750049711023 ,
 0.1209074929356575 , 4281.680261515167 ,
 0.27137720584869385 , 4291.744032208968 ,
 0.25529924035072327 , 4281.189783733889 ,
 0.06510010361671448 , 4251.17957043027 ,
 0.1192275658249855 , 4331.24234146438 ,
 0.14149686694145203 , 4231.200873741859 ,
 1.673265814781189 , 4171.182007270225 ,
 0.10142320394515991 , 4300.481047275765 ,
 1.9223331212997437 , 4075.519274992775 ,
 1.7056474685668945 , 4201.650726269243 ,
 0.20163027942180634 , 4294.0865849435395 ,
 1.9335887432098389 , 4069.9405117686347 ,
 0.07448710501194 , 4266.823984706572 ,
 2.385420560836792 , 4067.1159048207523 ,
 0.2249385565519333 , 4331.018858835765 ,
 0.11464415490627289 , 4296.793169615248 ,
 1.5118221044540405 , 4126.089760142699 ,
 0.035501256585121155 , 4251.025322205513 ,
 0.05363025516271591 , 4221.097906212357 ,
 0.11968187987804413 , 4271.162534252827 ,
 0.2902752161026001 , 4190.99778409764 ,
 0.05964396521449089 , 4231.342270682632 ,
 0.0994420051574707 , 4290.6977307012785 ,
 0.08183151483535767 , 4260.339719759189 ,
 0.05547202378511429 , 4227.848137680499 ,
 1.3862357139587402 , 4124.383553036934 ,
 0.14927951991558075 , 4301.549911678358 ,
 0.027098312973976135 , 4261.530482802706 ,
 0.034363240003585815 , 4241.439598294317 ,
 0.11109371483325958 , 4231.435795007307 ,
 0.22378163039684296 , 4201.271835559901 ,
 0.09548906236886978 , 4231.722227677939 ,
 2.0310263633728027 , 4060.323770866538 ,
 0.264675498008728 , 4326.856059033652 ,
 0.023496385663747787 , 4285.823932298538 ,
 0.3957407474517822 , 4259.90626716014 ,
 1.2753502130508423 , 4091.964698414883 ,
 83.63532257080078 , 9.153496803856415 ,
 0.04310418665409088 , 4280.912858963223 ,
 0.9819475412368774 , 4153.8719300993 ,
 1.2118622064590454 , 4104.461572596653 ,
 0.35459429025650024 , 4336.642633421024 ,
 1.2520004510879517 , 4142.439198181981 ,
 0.062119010835886 , 4256.100135846978 ,
 0.04129093512892723 , 4192.782120671503 ,
 0.06828922778367996 , 4194.081736831791 ,
 0.14274366199970245 , 4250.12927712984 ,
 0.1563182771205902 , 4305.571874130294 ,
 1.340332269668579 , 4134.485157907557 ,
 0.042842455208301544 , 4293.084275495621 ,
 0.05425219237804413 , 4264.103453697516 ,
 0.1317422240972519 , 4292.463794457198 ,
 0.036684148013591766 , 4225.270622406146 ,
 1.8038909435272217 , 4062.143577450842 ,
 1.915530800819397 , 4032.172101957396 ,
 0.059978850185871124 , 4202.942866924778 ,
 0.09541485458612442 , 4254.366336655261 ,
 0.16140183806419373 , 4276.887931503881 ,
 6.587655067443848 , 3723.699841081331 ,
 1.5521559715270996 , 4037.4044326095627 ,
 72.47984313964844 , 3.8904160921799478 ,
 1.3131091594696045 , 4065.037267999231 ,
 2.459700584411621 , 4067.5502716963397 ,
 0.03294532746076584 , 4274.387532967638 ,
 0.11431979387998581 , 4286.898027515837 ,
 0.2242734730243683 , 4313.152098338483 ,
 1.3709938526153564 , 4135.93125704098 ,
 1.32844877243042 , 4136.000038006375 ,
 0.02225906029343605 , 4274.878082484858 ,
 1.7065293788909912 , 4179.740178902292 ,
 0.3043844699859619 , 4195.2099207241845 ,
 0.18009261786937714 , 4313.738769131278 ,
 0.15603576600551605 , 4276.367911504276 ,
 5.846064567565918 , 3763.6494584552356 ,
 0.5860359072685242 , 3856.2323236503375 ,
 0.06700801849365234 , 4273.749975160008 ,
 1.3987287282943726 , 4064.754973726181 ,
 0.06401669234037399 , 4220.941517480407 ,
 0.38553720712661743 , 4170.864427828318 ,
 0.024100547656416893 , 4231.127338651622 ,
 0.062343619763851166 , 4250.959055405384 ,
 0.085725799202919 , 4260.941625755404 ,
 0.04109148681163788 , 4230.965374064135 ,
 0.13941356539726257 , 4261.060619859659 ,
 0.7828311920166016 , 4145.678573487005 ,
 0.06194652244448662 , 4220.963925087244 ,
 0.06663507968187332 , 4220.997954819342 ,
 0.08073754608631134 , 4252.083381449298 ,
 0.1819327473640442 , 4245.07705503248 ,
 0.12224350869655609 , 4253.090377284159 ,
 0.0991646945476532 , 4277.399190617565 ,
 0.08312870562076569 , 4232.200667146641 ,
 0.08146791905164719 , 4233.380422835229 ,
 0.09176458418369293 , 4262.492593260244 ,
 0.09405312687158585 , 4243.625593133118 ,
 0.18116335570812225 , 4316.419558638555 ,
 0.02898348867893219 , 4297.596336525968 ,
 0.025989636778831482 , 4271.169841410985 ,
 0.33636653423309326 , 4191.105180802172 ,
 0.08821645379066467 , 4231.3209104211555 ,
 0.05973653867840767 , 4261.314594186347 ,
 0.10962498933076859 , 4231.174048543174 ,
 1.432281732559204 , 4062.814942096615 ,
 0.1220070868730545 , 4264.983896183445 ,
 2.4809184074401855 , 4012.5344988504075 ,
 0.6803364753723145 , 4052.732025560633 ,
 0.1877932846546173 , 4235.020175949386 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Drawer-Close-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 3.7539315223693848 , 4090.7546933332287 ,
 4.078738212585449 , 3603.725440159832 ,
 3.538740634918213 , 4268.8654455606365 ,
 3.997405767440796 , 4004.9341218458603 ,
 4.4008402824401855 , 3.7859573944999845 ,
 3.683145523071289 , 4244.714813832259 ,
 3.5993611812591553 , 4297.968657090188 ,
 3.5255343914031982 , 4313.356170608937 ,
 3.694498300552368 , 4135.931354599076 ,
 3.4186315536499023 , 4274.634816045349 ,
 3.756112575531006 , 4072.4173072283793 ,
 3.41609787940979 , 4274.705154245389 ,
 3.6267857551574707 , 4179.745620511185 ,
 3.521394729614258 , 4318.993088585232 ,
 3.695901393890381 , 4234.6478812405385 ,
 4.075743198394775 , 3.7863932189073304 ,
 3.5401840209960938 , 4268.3800525178085 ,
 3.8943097591400146 , 4036.808132380025 ,
 4.154837131500244 , 3.8356080414671845 ,
 3.555042028427124 , 4272.882871895577 ,
 3.5432181358337402 , 4260.922821110798 ,
 3.4980931282043457 , 4280.975253440029 ,
 3.6420202255249023 , 4220.9175193471 ,
 3.6377034187316895 , 4180.872100476374 ,
 3.656432867050171 , 4231.153723039815 ,
 3.6325862407684326 , 4220.962126648167 ,
 3.5752930641174316 , 4220.99777893047 ,
 3.553067207336426 , 4251.065950909405 ,
 3.6574621200561523 , 4231.216957658133 ,
 3.753143072128296 , 4145.030378417212 ,
 3.5617289543151855 , 4263.925419306922 ,
 3.4935803413391113 , 4213.258771315667 ,
 3.653956890106201 , 4232.179157194125 ,
 3.4931602478027344 , 4253.102903578798 ,
 3.657963991165161 , 4192.166823094447 ,
 3.4732558727264404 , 4296.571091398494 ,
 3.6146106719970703 , 4243.518530781885 ,
 3.4593217372894287 , 4233.559565904164 ,
 3.5798685550689697 , 4262.493650267829 ,
 3.671008586883545 , 4234.037873277356 ,
 3.5955162048339844 , 4191.073115502051 ,
 3.5988008975982666 , 4241.465792854324 ,
 3.6063826084136963 , 4251.247773361187 ,
 3.5189318656921387 , 4261.302631949794 ,
 3.6573638916015625 , 4231.240375358822 ,
 3.9764509201049805 , 4052.6365426830203 ,
 3.6131937503814697 , 4184.953394798205 ,
 3.743316411972046 , 4203.032540599423 ,
 3.6023449897766113 , 4232.014919576645 ,
 3.5598766803741455 , 4257.4575187011815 ,
 4.563549995422363 , 4030.066535069182 ,
 3.665574312210083 , 4163.9867427667095 ,
 4.272034168243408 , 2850.717998847026 ,
 3.847932815551758 , 4157.886776003089 ,
 3.7693827152252197 , 4123.6351198510765 ,
 3.5918891429901123 , 4188.152301208813 ,
 3.8644490242004395 , 4060.2395721463463 ,
 4.545351505279541 , 4070.840186073814 ,
 3.8469297885894775 , 4153.362907848211 ,
 3.928852081298828 , 3855.06856301879 ,
 3.681058168411255 , 4191.075844187493 ,
 3.7389540672302246 , 4021.163323730636 ,
 3.7116506099700928 , 4171.098044233398 ,
 4.083912372589111 , 4101.101563204246 ,
 3.782663106918335 , 4141.100011732934 ,
 3.939835548400879 , 3993.742035502819 ,
 3.5923423767089844 , 4156.568401588687 ,
 4.575376987457275 , 4074.82410064427 ,
 3.710110664367676 , 4157.593180730712 ,
 3.7230498790740967 , 4220.106223691865 ,
 4.347301483154297 , 4131.4054929588165 ,
 3.7126247882843018 , 4121.4634400963405 ,
 3.7084648609161377 , 4171.387960004453 ,
 3.6842093467712402 , 4191.4213607183865 ,
 3.7627334594726562 , 4151.40947208093 ,
 4.61857795715332 , 4033.738898303047 ,
 3.3755714893341064 , 6.835896556454067 ,
 3.9773147106170654 , 4136.539673221824 ,
 3.8224050998687744 , 4075.8472620867333 ,
 4.400469779968262 , 4163.694170275174 ,
 4.373132705688477 , 4188.963958624727 ,
 3.412031888961792 , 8.399127524138194 ,
 4.257349967956543 , 4152.775121798014 ,
 3.8592350482940674 , 4068.820260368765 ,
 4.140403747558594 , 4037.3121044704226 ,
 3.777935266494751 , 4141.093071290242 ,
 4.8440022468566895 , 4012.638086640807 ,
 3.788832187652588 , 4102.611345489651 ,
 3.738269567489624 , 4167.0263834050165 ,
 3.738565683364868 , 4107.591888080444 ,
 3.587136745452881 , 4162.461722769071 ,
 3.8632731437683105 , 4038.8499511463324 ,
 4.5775146484375 , 4058.0754257378358 ,
 3.617741584777832 , 3974.105219485937 ,
 3.7142984867095947 , 4161.304036434638 ,
 4.779141426086426 , 4042.389527155273 ,
 3.7402114868164062 , 4114.468372230951 ,
 3.860999345779419 , 4092.87330559538 ,
 3.778994083404541 , 4136.677981728016 ,
 3.755021095275879 , 4052.3726940121023 ,
 4.623787879943848 , 3963.738920279733 ,
 4.040614604949951 , 4.247581608912016 ,
 3.688089609146118 , 4128.825845150734 ,
 4.73334264755249 , 5.145351894959512 ,
 4.741781234741211 , 3948.203558496329 ,
 3.758573293685913 , 4011.0280650586583 ,
 3.6953563690185547 , 4170.984809735437 ,
 3.8291804790496826 , 4111.003595865312 ,
 3.7559475898742676 , 4160.994547270823 ,
 3.719771385192871 , 4161.012655626052 ,
 3.736767053604126 , 4167.697235583151 ,
 4.567481517791748 , 2.572292628482709 ,
 3.8694605827331543 , 4083.753204376321 ,
 3.72877836227417 , 4151.057570192363 ,
 3.769239664077759 , 4112.700343062201 ,
 3.6875555515289307 , 4218.300447080505 ,
 4.249083042144775 , 3099.4317173352074 ,
 3.649717330932617 , 4154.066937459263 ,
 3.7521347999572754 , 4111.277665295936 ,
 4.6503729820251465 , 4059.513476475849 ,
 3.7031266689300537 , 4131.518120112406 ,
 3.7583398818969727 , 4161.407694501216 ,
 3.6706020832061768 , 4171.454162175225 ,
 4.329439640045166 , 4131.412927041109 ,
 3.6082849502563477 , 4181.458900577098 ,
 4.675163269042969 , 3963.879389784435 ,
 3.727182149887085 , 4175.053370267749 ,
 3.703993558883667 , 4123.2791654604225 ,
 4.8775482177734375 , 3975.3261648102825 ,
 4.798277854919434 , 3975.364049077322 ,
 3.6946263313293457 , 4170.944222451211 ,
 3.7750813961029053 , 4010.9809302209414 ,
 3.9144399166107178 , 4090.9679350016295 ,
 3.6845836639404297 , 4190.971781018376 ,
 3.828792095184326 , 4110.970897963674 ,
 3.716933012008667 , 4081.3110720941695 ,
 3.831601142883301 , 4111.314408645707 ,
 3.756471872329712 , 4121.2449046363845 ,
 3.720839023590088 , 4171.326587861258 ,
 3.7778844833374023 , 4001.2611753145707 ,
 3.781118154525757 , 4138.537755037763 ,
 3.753990411758423 , 4052.473512047891 ,
 3.731100559234619 , 4116.221367909672 ,
 3.8585591316223145 , 4082.573075363385 ,
 3.862647294998169 , 3952.3571504316556 ,
 3.750746250152588 , 4011.080574339403 ,
 3.7961180210113525 , 4131.010640326138 ,
 3.837609052658081 , 4111.040718116151 ,
 3.679276466369629 , 4191.038783669208 ,
 3.6862754821777344 , 4171.059724798549 ,
 3.7944984436035156 , 4137.609558039604 ,
 3.694885492324829 , 4112.667015859486 ,
 3.4801199436187744 , 4311.26349171429 ,
 3.713296890258789 , 4175.291083477865 ,
 3.7019121646881104 , 4182.0332934338785 ,
 3.723517894744873 , 4110.417931764602 ,
 3.5231175422668457 , 4324.0091345303845 ,
 3.4917445182800293 , 4279.619803445412 ,
 3.6832115650177 , 4244.815938054572 ,
 4.438741683959961 , 4275.384764901735 ,
 4.547565460205078 , 4231.048053378968 ,
 3.662362813949585 , 4151.017960679272 ,
 3.794448137283325 , 4161.038427259481 ,
 3.505479097366333 , 4211.060355671305 ,
 3.679244041442871 , 4231.043275945177 ,
 3.9561655521392822 , 4074.026834489983 ,
 3.496727466583252 , 4259.728288045441 ,
 3.7098262310028076 , 4228.572312750894 ,
 3.6938464641571045 , 4233.245184775689 ,
 3.756582021713257 , 4118.04926124845 ,
 3.72678279876709 , 4201.408264432681 ,
 3.7379183769226074 , 4101.319130889998 ,
 3.5000691413879395 , 4231.361004651838 ,
 3.7666561603546143 , 4171.351842742419 ,
 4.437149524688721 , 4201.5603222974205 ,
 3.715773820877075 , 4146.790931013276 ,
 3.4798007011413574 , 4300.975062110332 ,
 3.757507562637329 , 4157.701808747662 ,
 3.5035741329193115 , 4304.680702541096 ,
 3.792525291442871 , 6.924770357386999 ,
 4.1842942237854 , 4096.0324809634 ,
 3.479201078414917 , 4295.843873379821 ,
 3.6620841026306152 , 4255.633211219993 ,
 3.8003623485565186 , 4131.775400472934 ,
 3.5960848331451416 , 4269.077393667938 ,
 3.7124741077423096 , 4052.5594295664155 ,
 3.6080665588378906 , 4223.1960421327 ,
 3.796828508377075 , 4169.906100066463 ,
 4.666196346282959 , 4165.906474307836 ,
 4.686262130737305 , 4062.705331704763 ,
 3.497873306274414 , 4265.149374474038 ,
 3.869838237762451 , 4.2101412708782915 ,
 4.484459400177002 , 4259.833897740845 ,
 3.7591912746429443 , 4118.843209115861 ,
 3.4893670082092285 , 4299.104578727071 ,
 3.6683692932128906 , 4212.123924097795 ,
 4.616291046142578 , 4175.799368961097 ,
 3.71673583984375 , 4062.414247290637 ,
 3.7315480709075928 , 4052.348750157059 ,
 4.734600067138672 , 4174.251894927447 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Drawer-Close-V2',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()

returns = []
path = './data/peg-insert-side-v2med'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 0.7877908945083618 , 204.47102474705878 ,
 0.037057362496852875 , 7.9111156073021505 ,
 0.7373403906822205 , 85.71396682356587 ,
 0.05562151223421097 , 39.04405976742193 ,
 0.032319046556949615 , 11.098482466798618 ,
 0.38606977462768555 , 182.2441953860923 ,
 0.15917843580245972 , 4548.226839342529 ,
 0.04082783684134483 , 8.531102251730292 ,
 0.0652044415473938 , 29.033022095619806 ,
 0.033175304532051086 , 7.252892657217304 ,
 0.06309700012207031 , 14.553911540711006 ,
 0.030592210590839386 , 14.56192894526885 ,
 0.02604692243039608 , 9.480646732155497 ,
 2.486234188079834 , 130.7810290823148 ,
 5.290256023406982 , 138.1439567046099 ,
 0.08539102971553802 , 19.11834752503624 ,
 5.783734321594238 , 144.1749784799373 ,
 9.505208015441895 , 146.95395498086296 ,
 0.155424103140831 , 4533.465747101045 ,
 0.10093926638364792 , 4556.956948277055 ,
 0.032952237874269485 , 9.361013505151243 ,
 0.6256133317947388 , 121.90679201284809 ,
 0.038014139980077744 , 24.624032513732296 ,
 0.03288482502102852 , 10.236621731192294 ,
 2.2298130989074707 , 230.9887639932415 ,
 0.03785192593932152 , 23.442888509015447 ,
 1.3104660511016846 , 2056.4467557804583 ,
 0.027275465428829193 , 10.70017450310876 ,
 0.03495558351278305 , 10.262981085038053 ,
 0.028087947517633438 , 9.306974911066565 ,
 0.05906987935304642 , 14.501604160739628 ,
 0.031384486705064774 , 13.324523461565828 ,
 11.550162315368652 , 399.3317990075432 ,
 16.047027587890625 , 1562.2458615211099 ,
 0.04264327138662338 , 20.681567737162162 ,
 0.036009423434734344 , 11.61846455068817 ,
 0.03374875709414482 , 6.873291256270541 ,
 7.166234970092773 , 203.76632392443094 ,
 47.7626953125 , 1321.484521011986 ,
 0.3260469436645508 , 4515.687127423871 ,
 0.03753111511468887 , 20.28137623782814 ,
 0.04065617546439171 , 7.866722520580427 ,
 6.755135536193848 , 284.7105010300215 ,
 0.03454972058534622 , 13.959792603548651 ,
 0.04214164614677429 , 19.40198535399456 ,
 34.39231872558594 , 161.72672135268112 ,
 6.8050456047058105 , 145.94525565943792 ,
 0.02559945173561573 , 16.333697416185373 ,
 25.20867919921875 , 1309.1905815751245 ,
 0.45355087518692017 , 76.19979763793368 ,
 0.030699528753757477 , 16.464585370043963 ,
 5.462042808532715 , 152.92788758135373 ,
 0.5872782468795776 , 98.37134765700705 ,
 4.707951545715332 , 72.35098203205753 ,
 0.05535997450351715 , 9.279411713757213 ,
 0.14741460978984833 , 4480.756845206601 ,
 0.23319023847579956 , 844.1891985416329 ,
 0.033393993973731995 , 7.0231259053990716 ,
 0.034461859613657 , 12.835294469041427 ,
 0.06471675634384155 , 14.286844082796234 ,
 0.040641993284225464 , 7.622804393651441 ,
 1.0209898948669434 , 4371.272376532817 ,
 0.3852393627166748 , 68.53135709151378 ,
 0.22495299577713013 , 9.985819743081457 ,
 0.07402573525905609 , 8.499388884228344 ,
 0.27446356415748596 , 289.3718661080535 ,
 0.10785716772079468 , 10.333494707420094 ,
 1.0328795909881592 , 101.1643101339545 ,
 0.22791306674480438 , 19.201279846625063 ,
 0.033815670758485794 , 10.349038988150584 ,
 0.06855137646198273 , 4589.132096487358 ,
 0.1316419243812561 , 2.9890095415548075 ,
 0.29245615005493164 , 4514.95321483684 ,
 1.4984136819839478 , 3043.457709359261 ,
 0.09255151450634003 , 7.886552455056492 ,
 0.06857415288686752 , 16.038377280715252 ,
 0.08845236897468567 , 4.45933757158293 ,
 1.0518462657928467 , 4360.6979647348735 ,
 0.30535048246383667 , 62.04299934856468 ,
 0.5384492874145508 , 68.80290457934036 ,
 0.03835662454366684 , 9.283460063236276 ,
 0.06030132621526718 , 4491.202194645762 ,
 0.34875601530075073 , 18.78406879676411 ,
 0.06965504586696625 , 10.013480080366502 ,
 0.08297087252140045 , 9.918656034797928 ,
 0.03232619911432266 , 2.424216322318502 ,
 0.035020891577005386 , 15.43229040183091 ,
 0.03073900192975998 , 18.951555721411793 ,
 0.09368257224559784 , 13.919803036798193 ,
 0.07239539921283722 , 15.758117343710582 ,
 0.07714532315731049 , 4257.895431353244 ,
 2.0752973556518555 , 84.22996333015942 ,
 21.20016098022461 , 215.06833785272985 ,
 0.05456418916583061 , 12.316314143375688 ,
 19.435474395751953 , 211.15672530716722 ,
 0.18769237399101257 , 4.475078236165701 ,
 0.1499572992324829 , 577.9765648200068 ,
 0.03125692531466484 , 19.527822555779217 ,
 2.610671281814575 , 48.753581557065154 ,
 1.7096389532089233 , 44.17905140612476 ,
 0.05984119698405266 , 4.422574609138771 ,
 9.71536636352539 , 232.53188188677106 ,
 0.3172166347503662 , 19.736099274636288 ,
 0.07251538336277008 , 7.9043961160518155 ,
 0.0670742467045784 , 13.03986311506695 ,
 0.032807327806949615 , 7.664294609717901 ,
 0.1137051209807396 , 6.7346814826491155 ,
 0.037620075047016144 , 20.457568407623015 ,
 0.07086579501628876 , 35.332007764844256 ,
 7.694056034088135 , 194.54741766877066 ,
 0.23997972905635834 , 2.610041458802969 ,
 4.016056060791016 , 57.65691191922103 ,
 0.025000276044011116 , 7.53105843691756 ,
 0.02153169922530651 , 11.512137518430507 ,
 0.02626213990151882 , 10.640717278451412 ,
 0.023843590170145035 , 7.955251782523324 ,
 4.871504783630371 , 127.57925923885861 ,
 34.972938537597656 , 139.25144489389626 ,
 26.764678955078125 , 663.9845199298526 ,
 0.03569986671209335 , 10.65477826117396 ,
 0.03596362844109535 , 14.15317832197212 ,
 12.117395401000977 , 760.3651081361742 ,
 0.6370630860328674 , 3.7265149813791956 ,
 0.08970491588115692 , 12.700715086149403 ,
 0.056905269622802734 , 8.402577240276997 ,
 0.1061878353357315 , 15.228149753136783 ,
 78.29240417480469 , 153.56077831867722 ,
 0.12384002655744553 , 7.544374832919804 ,
 0.24228623509407043 , 10.718099420988338 ,
 24.49388885498047 , 348.5927262010988 ,
 0.030074937269091606 , 16.924324827755626 ,
 0.025310378521680832 , 4.071203840456738 ,
 0.03375740349292755 , 4.888733695710382 ,
 0.03392307087779045 , 11.230988098792231 ,
 0.0395752489566803 , 7.713330378905455 ,
 32.49896240234375 , 2856.9810383467884 ,
 86.46920013427734 , 94.97749062954495 ,
 0.03366946429014206 , 7.324301944991509 ,
 1.4928059577941895 , 113.25572221319686 ,
 72.67495727539062 , 718.1530018100565 ,
 0.035129256546497345 , 16.541998355745854 ,
 0.025671958923339844 , 8.668873160520567 ,
 0.025624243542551994 , 8.217395098936956 ,
 0.03581995144486427 , 7.428280558166321 ,
 5.117219924926758 , 127.54382922422788 ,
 19.655187606811523 , 188.17511794975843 ,
 33.43743896484375 , 292.7371733050117 ,
 40.67047119140625 , 204.8854054677067 ,
 0.6938362717628479 , 187.25335249009098 ,
 2.3318543434143066 , 160.1495574708125 ,
 0.20010919868946075 , 4532.295253904242 ,
 0.233506977558136 , 4520.868558179951 ,
 0.8921456336975098 , 4457.243283738688 ,
 0.36555707454681396 , 11.963615925515484 ,
 0.1317097544670105 , 5.675033781790736 ,
 0.065395787358284 , 36.84046590790898 ,
 0.037912145256996155 , 8.996315898001692 ,
 0.14879855513572693 , 4593.846101633586 ,
 0.9216210842132568 , 53.45652411545294 ,
 0.026892874389886856 , 12.623088010303071 ,
 0.026296677067875862 , 17.512555314584446 ,
 0.023089740425348282 , 7.719050896355185 ,
 0.10267587006092072 , 4390.211203453492 ,
 0.062278904020786285 , 8.63156251783715 ,
 0.037214554846286774 , 17.823828209620153 ,
 8.519145011901855 , 119.5728218275832 ,
 0.18881815671920776 , 8.875546706411683 ,
 3.301727294921875 , 97.17568803040696 ,
 0.15758490562438965 , 21.88598043925327 ,
 0.09852306544780731 , 21.3642456031112 ,
 0.031148137524724007 , 17.958013679683713 ,
 5.88677978515625 , 127.2353432358208 ,
 0.03029145486652851 , 17.551625837680106 ,
 0.45401811599731445 , 53.867355439540184 ,
 0.03125743195414543 , 18.739365285631912 ,
 0.0385240763425827 , 3.154487022246925 ,
 0.3094395399093628 , 18.458604374389225 ,
 5.479981422424316 , 2.8630728159261762 ,
 0.0604143962264061 , 3.1551392024674083 ,
 5.436652183532715 , 119.02604186251095 ,
 40.01857376098633 , 159.54020663619514 ,
 16.972434997558594 , 183.53535290298103 ,
 6.804312705993652 , 44.753720551846996 ,
 8.479537963867188 , 100.41568826599338 ,
 0.3378944396972656 , 1.0330696223098088 ,
 0.03647589683532715 , 9.617208203275428 ,
 0.0371328666806221 , 16.176986416242297 ,
 0.028593046590685844 , 8.04434715048771 ,
 0.12669871747493744 , 4520.835097239073 ,
 0.06827346980571747 , 9.295214394634622 ,
 4.8996124267578125 , 530.7418111203589 ,
 6.456133842468262 , 5.137744918455255 ,
 3.9964540004730225 , 217.82334643913248 ,
 0.10916514694690704 , 6.803838361066495 ,
 0.5033896565437317 , 83.65812550917218 ,
 5.985690116882324 , 160.08516738275037 ,
 0.17181159555912018 , 10.572461225417557 ,
 2.893773317337036 , 108.08402964630754 ,
 2.0154483318328857 , 15.805985583244565 ,
 0.4038265347480774 , 12.01318817512836 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Peg-Insert-Side-V2 (Med)',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 1.5304491519927979 , 114.37227082793117 ,
 2.749818801879883 , 4555.818893189556 ,
 3.5385348796844482 , 2753.3391660627817 ,
 2.5730507373809814 , 4273.179649563675 ,
 3.1318039894104004 , 4370.261012265189 ,
 0.014219550415873528 , 8.987538369126703 ,
 3.3263208866119385 , 147.86695647065997 ,
 0.022336523979902267 , 6.957519800027596 ,
 2.344454050064087 , 4341.797533758009 ,
 1.455498456954956 , 94.37028791677415 ,
 4.565646648406982 , 502.45143964313206 ,
 0.04436436668038368 , 17.36597681003726 ,
 1.7395005226135254 , 103.25551377215716 ,
 3.0605618953704834 , 98.50276719220854 ,
 0.02791867032647133 , 17.19862803417269 ,
 1.0000090599060059 , 83.71419412971208 ,
 0.5266090035438538 , 15.840477648062965 ,
 0.16653653979301453 , 11.014332615525468 ,
 0.011111694388091564 , 21.22841387879577 ,
 0.43429329991340637 , 620.0393450373192 ,
 0.028406307101249695 , 13.871541154088678 ,
 0.012173525989055634 , 15.129690190587791 ,
 0.5185831785202026 , 53.747252775018666 ,
 0.0691448301076889 , 16.521587691365976 ,
 0.3251454532146454 , 65.67810660914809 ,
 0.2641359865665436 , 51.66343522388207 ,
 0.3187851011753082 , 2.8565350977414887 ,
 3.571159601211548 , 127.06586820389948 ,
 0.31286317110061646 , 6.972604376688571 ,
 0.33050867915153503 , 10.015494547061088 ,
 4.938650608062744 , 159.54020663619514 ,
 2.515789747238159 , 127.15953917952002 ,
 0.18624533712863922 , 12.748563822584586 ,
 0.02685406431555748 , 7.517721648821873 ,
 4.76124906539917 , 91.62771982156703 ,
 3.3346147537231445 , 2855.7448385566768 ,
 0.2806500494480133 , 8.527963227093906 ,
 2.970038414001465 , 4360.544132527619 ,
 1.4400959014892578 , 14.259728880468344 ,
 0.06304962933063507 , 4.737311753529251 ,
 0.20214757323265076 , 10.806895033064052 ,
 1.8429741859436035 , 73.20459565115365 ,
 1.3283982276916504 , 112.32455303016938 ,
 0.04043816775083542 , 23.777868418659388 ,
 1.1439132690429688 , 90.24756325032386 ,
 3.4199397563934326 , 99.28181702322362 ,
 0.335232675075531 , 17.574017135123984 ,
 3.1487905979156494 , 141.75701027679935 ,
 3.414924383163452 , 3549.2724161327606 ,
 0.611747682094574 , 652.4272622200015 ,
 0.18478578329086304 , 4.273478033234323 ,
 2.678086519241333 , 1372.008089952449 ,
 3.8637733459472656 , 213.23916251839492 ,
 2.511725902557373 , 4581.21982405106 ,
 0.012805895879864693 , 42.18572377527899 ,
 0.20686927437782288 , 24.681061072631465 ,
 2.4277100563049316 , 148.34959876494494 ,
 0.3363560140132904 , 10.2827701506337 ,
 0.023527875542640686 , 11.25579703466573 ,
 1.82857084274292 , 205.12753791930837 ,
 0.38118937611579895 , 4.436740609908405 ,
 0.020116014406085014 , 15.181894821065324 ,
 0.03589000552892685 , 8.506949061907743 ,
 0.04456541687250137 , 8.107480556614082 ,
 0.10767828673124313 , 10.466921387390151 ,
 3.0778346061706543 , 153.344457415209 ,
 2.3067476749420166 , 95.97534159852974 ,
 1.0763823986053467 , 14.509458334961378 ,
 3.3736138343811035 , 4270.661043657736 ,
 0.291420578956604 , 9.393472481076252 ,
 0.15734732151031494 , 10.367730930845383 ,
 0.04036650061607361 , 94.18951620362668 ,
 0.24377426505088806 , 9.72090404502768 ,
 2.2080347537994385 , 185.23988103143168 ,
 0.013003235682845116 , 56.20414835781835 ,
 1.1643315553665161 , 369.7158192707627 ,
 0.4882926046848297 , 2.867710186978529 ,
 0.02792118676006794 , 13.2350873635957 ,
 0.013499170541763306 , 10.583487866851778 ,
 3.3243093490600586 , 4011.1591051826786 ,
 4.09030818939209 , 93.58358960919578 ,
 2.6447272300720215 , 131.69082995188384 ,
 0.009634001180529594 , 4.011926488326154 ,
 1.9466913938522339 , 123.48685229086962 ,
 0.07249791920185089 , 39.618167301784695 ,
 2.778108596801758 , 432.4979772270379 ,
 2.9286694526672363 , 23.861057077758705 ,
 3.321575164794922 , 292.61539819074824 ,
 0.012096932157874107 , 10.896600716113497 ,
 4.157455921173096 , 196.7230091419997 ,
 0.6609878540039062 , 5.017031526805436 ,
 0.06867453455924988 , 6.391194443270811 ,
 0.02292444184422493 , 11.074807770411521 ,
 3.4988157749176025 , 193.2753321822744 ,
 0.2259385883808136 , 19.940018688118073 ,
 0.24052274227142334 , 25.763796759229585 ,
 0.3362995684146881 , 18.93654885113989 ,
 2.427974224090576 , 169.59623957610438 ,
 0.5336976051330566 , 6.186194688397378 ,
 0.12246878445148468 , 10.411743105528192 ,
 3.0468671321868896 , 4281.049010498347 ,
 2.7231264114379883 , 4561.210720762934 ,
 0.125193789601326 , 9.66962524621346 ,
 0.5334843397140503 , 36.39615697368179 ,
 0.24296842515468597 , 9.25343970460095 ,
 2.8393821716308594 , 4531.349229877357 ,
 2.6201817989349365 , 140.94279387778192 ,
 0.4919007420539856 , 24.825731201901657 ,
 0.31707268953323364 , 42.40622000664919 ,
 0.008166196756064892 , 8.907775037680924 ,
 0.09534445405006409 , 56.46688040474932 ,
 0.01682049036026001 , 11.985270184319518 ,
 1.1439522504806519 , 62.65936488977872 ,
 0.012233193963766098 , 9.445926279923427 ,
 0.15400256216526031 , 2.88663065929428 ,
 2.174186944961548 , 135.78026960330428 ,
 1.832078456878662 , 40.989915433652115 ,
 2.742072343826294 , 4495.713250646124 ,
 1.1656724214553833 , 50.055402734220614 ,
 0.007138699293136597 , 10.345117504957544 ,
 3.7106120586395264 , 123.14000663689205 ,
 1.5382732152938843 , 517.8375397567702 ,
 2.373009204864502 , 187.53863242470624 ,
 3.5459580421447754 , 837.5589500764145 ,
 0.26589590311050415 , 13.573675798859782 ,
 0.3322344720363617 , 19.058372246832093 ,
 3.517340898513794 , 167.42437777931562 ,
 2.4526078701019287 , 145.1407604417237 ,
 2.686821937561035 , 3104.872745574614 ,
 0.4317575693130493 , 3.9952552172427103 ,
 0.06921695917844772 , 6.789784489687464 ,
 2.6901378631591797 , 165.16360573472969 ,
 0.5355525016784668 , 66.7191425845439 ,
 0.006921190302819014 , 24.293227679239585 ,
 0.014387224800884724 , 14.848270389237564 ,
 0.01462236512452364 , 10.617413854092227 ,
 2.780909299850464 , 4539.450279650333 ,
 0.20037327706813812 , 12.642987700416544 ,
 0.04663195088505745 , 12.395765586113981 ,
 4.164914608001709 , 131.25809053099266 ,
 0.05013108253479004 , 14.435907613074765 ,
 0.5449406504631042 , 26.5475169085807 ,
 0.035168200731277466 , 42.851269051388456 ,
 0.004392492584884167 , 13.54113305962046 ,
 0.023387612774968147 , 77.71750166571351 ,
 2.4676976203918457 , 163.02366276356585 ,
 0.006412545684725046 , 7.5695410126016185 ,
 0.41686391830444336 , 60.95106767975055 ,
 0.2799694836139679 , 13.859166843314227 ,
 0.16653528809547424 , 9.24867860753796 ,
 2.4743857383728027 , 82.21832074011462 ,
 0.014024024829268456 , 23.10504044822634 ,
 0.0143359350040555 , 11.100615543248729 ,
 2.743285655975342 , 4393.164275412525 ,
 0.011965792626142502 , 36.121673129854074 ,
 0.1817491501569748 , 56.60025320633837 ,
 2.3768627643585205 , 195.37562787793658 ,
 0.05235902592539787 , 31.863466465674005 ,
 0.2438344955444336 , 4.978528034538054 ,
 0.18465998768806458 , 22.658489630391365 ,
 0.014486325904726982 , 4.005884265410664 ,
 0.10665402561426163 , 32.18139338786528 ,
 0.3149552345275879 , 7.100344240360888 ,
 0.060981981456279755 , 4.606960557353197 ,
 0.6207897663116455 , 15.629952585578796 ,
 2.325314521789551 , 118.83147591048152 ,
 3.020390748977661 , 161.46369285923817 ,
 0.5124469995498657 , 60.59186242424124 ,
 2.6746180057525635 , 165.85400398405255 ,
 1.9985761642456055 , 8.700841939456595 ,
 2.920135259628296 , 223.2495905027923 ,
 0.7171371579170227 , 13.535275141589743 ,
 0.016879703849554062 , 10.460989733872594 ,
 0.5346643328666687 , 9.888684996985381 ,
 0.23022675514221191 , 11.852988482426676 ,
 2.698457956314087 , 1833.3463273218538 ,
 0.02788485214114189 , 7.082955618205386 ,
 0.033829011023044586 , 10.73647893300832 ,
 0.016269246116280556 , 8.024845072148695 ,
 0.33300498127937317 , 107.98899165777674 ,
 0.1394919902086258 , 7.783614020756831 ,
 0.03936577960848808 , 5.7255384503921585 ,
 0.30814629793167114 , 16.61592200909012 ,
 2.620673418045044 , 148.3500731526409 ,
 0.055218104273080826 , 5.592953389785485 ,
 2.708681344985962 , 4569.74315630075 ,
 3.7355451583862305 , 167.55336627576827 ,
 2.721048593521118 , 4488.233768504339 ,
 2.7971107959747314 , 146.98228091653 ,
 3.6909780502319336 , 158.77238598441025 ,
 3.108599901199341 , 148.82942231860375 ,
 0.08594320714473724 , 38.695632346712216 ,
 2.751112461090088 , 4475.755091051219 ,
 0.10648447275161743 , 10.982277941958422 ,
 0.1549721509218216 , 21.96611299194047 ,
 0.03304819017648697 , 9.183473022574361 ,
 2.3315305709838867 , 110.64618569314567 ,
 2.7508161067962646 , 188.569353205052 ,
 0.10223300009965897 , 20.546952067994326 ,
 2.669804096221924 , 180.7028419184292 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Peg-Insert-Side-V2 (Med)',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()

returns = []
path = './data/sweep-v2med'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step49500.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(500)
for r in returns:
 idx = int(np.floor(r/10))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 0.7933223247528076 , 15.925840260247444 ,
 0.6737880110740662 , 17.994205584939387 ,
 2.3742690086364746 , 73.04337801101053 ,
 0.9018528461456299 , 64.85207287691777 ,
 0.14466676115989685 , 21.279779599431542 ,
 1.3077577352523804 , 61.00233405315072 ,
 3.3565216064453125 , 200.44398456679107 ,
 0.7037484645843506 , 53.27346787661621 ,
 0.8295544385910034 , 40.23235140882911 ,
 2.7883291244506836 , 88.4848638831691 ,
 3.513758420944214 , 11.802212943477384 ,
 1.4239230155944824 , 586.3869307846139 ,
 0.5346115231513977 , 18.123292327855314 ,
 1.4696385860443115 , 43.559135039423566 ,
 0.05688092112541199 , 1149.9031286637426 ,
 0.18398618698120117 , 32.264928484994726 ,
 0.5951751470565796 , 16.451933256072692 ,
 0.08370576798915863 , 17.788707308119 ,
 0.8748854994773865 , 18.814445756220955 ,
 3.333743095397949 , 4332.665230639386 ,
 0.9405978918075562 , 53.42794284944324 ,
 1.2307419776916504 , 54.4126320556998 ,
 0.5552828907966614 , 4188.635436687287 ,
 2.152122974395752 , 48.68634339250856 ,
 1.5305603742599487 , 20.60254256473707 ,
 0.08578638732433319 , 4423.34226804807 ,
 0.6806198358535767 , 30.04690477719423 ,
 0.11446090787649155 , 33.43554083634512 ,
 0.2776167392730713 , 46.10021272636255 ,
 0.05861250311136246 , 27.39193429260168 ,
 0.47142112255096436 , 50.62917611120507 ,
 0.24493519961833954 , 51.018411279590964 ,
 0.5299537181854248 , 38.489520012853596 ,
 1.7944307327270508 , 3793.9311840369814 ,
 1.9492379426956177 , 63.18439217885751 ,
 0.8639736175537109 , 68.83475844411971 ,
 2.230299472808838 , 46.285123190290406 ,
 14.338115692138672 , 155.14933535118922 ,
 3.0142245292663574 , 50.48437102371169 ,
 1.568429946899414 , 62.84316282803119 ,
 0.258699506521225 , 18.684435186187443 ,
 0.3503005802631378 , 54.415070025175154 ,
 3.8399486541748047 , 54.29174274012041 ,
 0.853697657585144 , 40.57024715851037 ,
 33.29570007324219 , 1554.698749343415 ,
 0.3673819303512573 , 4418.16200024824 ,
 4.934717655181885 , 39.88989912746031 ,
 0.4394846558570862 , 45.44483384617733 ,
 0.18873876333236694 , 4512.837781466584 ,
 0.6823544502258301 , 4396.134827934748 ,
 3.50858736038208 , 52.97092966000531 ,
 1.3085675239562988 , 16.496894043920214 ,
 0.1408812403678894 , 4418.73630951204 ,
 0.3149389326572418 , 4339.1187402328815 ,
 15.42003345489502 , 18.997142751881565 ,
 0.6657654643058777 , 4370.517606364518 ,
 0.1263953149318695 , 16.121853982930702 ,
 0.21462565660476685 , 31.51328849121368 ,
 0.42344382405281067 , 4400.882995029808 ,
 1.4293400049209595 , 3970.5293296193317 ,
 71.65066528320312 , 4475.661503089794 ,
 2.5558738708496094 , 4175.966746166226 ,
 3.1703250408172607 , 47.299919079081874 ,
 0.8228943347930908 , 24.883445125893154 ,
 0.6978408098220825 , 81.06870080627934 ,
 0.06335344165563583 , 4376.436851786037 ,
 1.6136099100112915 , 14.62434334355925 ,
 0.39399540424346924 , 59.76008440445909 ,
 3.93990421295166 , 21.68495290559827 ,
 1.7066446542739868 , 53.10380317058998 ,
 0.49875056743621826 , 4311.02080112486 ,
 0.6895543932914734 , 78.15427234494034 ,
 0.053874898701906204 , 4437.449062490904 ,
 3.652832508087158 , 40.10447830970249 ,
 1.059279203414917 , 421.13147967300534 ,
 1.335263729095459 , 48.65554593648855 ,
 3.919347047805786 , 57.03271386698328 ,
 0.23892974853515625 , 21.882324693077788 ,
 6.4554290771484375 , 3852.7662911098187 ,
 1.3460462093353271 , 654.6316045914889 ,
 1.0980207920074463 , 56.46756085542428 ,
 4.421375751495361 , 3208.5811166889116 ,
 1.8690139055252075 , 32.18449071238394 ,
 7.7527947425842285 , 1338.259375151686 ,
 1.7457667589187622 , 61.21933327320937 ,
 3.440910577774048 , 20.649332117974467 ,
 0.4891709089279175 , 21.293677378871887 ,
 0.19010716676712036 , 4396.967167410021 ,
 0.9393547773361206 , 78.9716311723539 ,
 0.06963866204023361 , 4425.196566330326 ,
 0.12386862933635712 , 32.23750737420489 ,
 2.40742826461792 , 48.98383842878471 ,
 0.3234122395515442 , 60.577783080085425 ,
 1.5176060199737549 , 234.65427144033072 ,
 0.46393296122550964 , 12.258714368432695 ,
 2.057131290435791 , 57.880543236562 ,
 0.5611868500709534 , 54.872389516109564 ,
 2.440758466720581 , 128.04464403421906 ,
 0.5038785934448242 , 4323.2599860894225 ,
 0.9585908055305481 , 58.24444319502199 ,
 1.667405605316162 , 81.21830756409439 ,
 1.050258755683899 , 59.64855148823597 ,
 0.06990307569503784 , 19.93805704468353 ,
 0.09367265552282333 , 20.027671986806162 ,
 0.7956427931785583 , 60.39532956472039 ,
 0.12556838989257812 , 4412.3369831229065 ,
 1.5695916414260864 , 116.75921771733667 ,
 0.10339276492595673 , 4440.833110360602 ,
 1.6800553798675537 , 72.27135984079351 ,
 1.1048723459243774 , 4327.992351821674 ,
 2.0728960037231445 , 52.00616738398803 ,
 0.25504884123802185 , 18.057155412199194 ,
 0.3771193027496338 , 30.749229322378383 ,
 2.932832717895508 , 57.83912488493019 ,
 1.2121233940124512 , 61.041413725639416 ,
 0.33821484446525574 , 29.819831345118956 ,
 1.0774836540222168 , 86.92255937919825 ,
 0.33545851707458496 , 4363.938238083896 ,
 0.7477861642837524 , 60.10203790931923 ,
 0.1817663013935089 , 28.940226894810152 ,
 1.051274061203003 , 38.41735019366682 ,
 0.44668763875961304 , 4410.444294050838 ,
 1.1678309440612793 , 86.06675480185243 ,
 1.2380757331848145 , 68.4813394714441 ,
 0.6917780637741089 , 31.777556694756683 ,
 1.0501493215560913 , 55.490974747180815 ,
 0.3067305386066437 , 35.260786478245336 ,
 1.9134330749511719 , 49.34971459782467 ,
 1.0225831270217896 , 53.73613139548526 ,
 1.9563767910003662 , 42.0002712079489 ,
 1.010127305984497 , 50.71641647589625 ,
 1.4478025436401367 , 45.49778918276573 ,
 0.5283507108688354 , 46.817225910564005 ,
 0.5256239175796509 , 80.31414493284255 ,
 2.0435667037963867 , 80.17532942427205 ,
 2.0661935806274414 , 4275.605213396257 ,
 2.4595892429351807 , 51.57325107528524 ,
 3.6769137382507324 , 77.73355479589834 ,
 2.9163594245910645 , 3880.7342236302575 ,
 0.5035988092422485 , 4236.229179134531 ,
 2.067054271697998 , 35.630018188382266 ,
 0.4422810673713684 , 166.07354874320288 ,
 9.485758781433105 , 44.238676550097736 ,
 1.3345110416412354 , 46.80737932466114 ,
 0.09060853719711304 , 4516.938502239484 ,
 0.06891295313835144 , 18.29014178410985 ,
 1.4975039958953857 , 4325.8593467057135 ,
 0.22295144200325012 , 1160.3048836840817 ,
 0.094994455575943 , 35.4221537580365 ,
 0.19621646404266357 , 4450.684861387848 ,
 0.2892875075340271 , 23.119941037256822 ,
 2.7182037830352783 , 61.188394404099625 ,
 0.7595160603523254 , 4344.1332654434555 ,
 0.0906168594956398 , 4496.873575999583 ,
 0.5625209808349609 , 4444.954237531207 ,
 1.290797472000122 , 57.91327134950908 ,
 0.1002516970038414 , 20.6798514315822 ,
 4.3301544189453125 , 35.245525842560156 ,
 2.3516087532043457 , 51.06590330192507 ,
 0.4040983319282532 , 35.50390571013824 ,
 4.076982021331787 , 43.18318478899694 ,
 0.2922826409339905 , 4520.734693201487 ,
 0.6429426670074463 , 52.49306278652007 ,
 0.5868013501167297 , 4384.402135590705 ,
 7.849727153778076 , 40.80076068302304 ,
 0.15558549761772156 , 41.57913410963498 ,
 1.6080121994018555 , 47.996272314757036 ,
 1.661909818649292 , 4132.95254527696 ,
 3.064075469970703 , 43.77189855157474 ,
 7.235714435577393 , 3393.435251639657 ,
 1.4588868618011475 , 15.041333059327219 ,
 0.25516292452812195 , 3972.5738480469254 ,
 26.43337631225586 , 1675.9060523937314 ,
 0.23452788591384888 , 19.103479157306904 ,
 2.185415267944336 , 44.413363029300804 ,
 0.6240055561065674 , 67.85570275960674 ,
 0.6812747716903687 , 75.38617558314596 ,
 5.184275150299072 , 55.054724870356445 ,
 3.939588785171509 , 48.01928727805384 ,
 0.20187105238437653 , 48.266733471981894 ,
 3.5302624702453613 , 38.7192041848738 ,
 4.977190971374512 , 60.9302571514056 ,
 2.5481162071228027 , 3853.4725957899086 ,
 1.3893591165542603 , 355.61184296285376 ,
 1.5209847688674927 , 56.97763711144701 ,
 0.4253813922405243 , 4484.475313762578 ,
 0.07011233270168304 , 74.77725185793545 ,
 33.69695281982422 , 1907.8844809852071 ,
 1.9238967895507812 , 88.69058766587716 ,
 2.5356485843658447 , 52.6653221923628 ,
 0.37837353348731995 , 36.22296316744047 ,
 1.9044634103775024 , 54.185070683370284 ,
 0.17849980294704437 , 4499.657463356558 ,
 1.1311724185943604 , 4284.86931352665 ,
 1.1098973751068115 , 79.89009875937728 ,
 73.22775268554688 , 136.28778597152075 ,
 16.166719436645508 , 2622.778500476431 ,
 2.3352227210998535 , 224.6392679133154 ,
 0.12817516922950745 , 27.71093822555231 ,
 0.14418840408325195 , 48.497025046985335 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Sweep-V2 (Med)',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 0.3333689570426941 , 23.20004944963005 ,
 2.70232892036438 , 4465.103714332368 ,
 0.3329298496246338 , 21.343076196956545 ,
 0.7395161390304565 , 61.95229178514128 ,
 2.659874439239502 , 4497.887007777679 ,
 0.4511331021785736 , 106.25889590912566 ,
 0.2597236931324005 , 21.87493665822852 ,
 0.4897449314594269 , 42.51595441552994 ,
 0.2824411392211914 , 37.71467823721912 ,
 2.9158999919891357 , 3943.16776603747 ,
 2.666210651397705 , 4461.459985772795 ,
 0.563551664352417 , 29.444940473016487 ,
 0.5230801105499268 , 25.357645684618255 ,
 0.28990328311920166 , 61.64059499430571 ,
 0.36858299374580383 , 76.00481289574452 ,
 0.5393996834754944 , 46.680695488503424 ,
 2.6163010597229004 , 4506.565850428883 ,
 0.36190006136894226 , 34.54507904983893 ,
 0.5860493183135986 , 52.556566545278166 ,
 1.188187837600708 , 33.756214584044415 ,
 0.7004050612449646 , 35.502514405201865 ,
 0.32055336236953735 , 44.43877346559689 ,
 0.3134426474571228 , 19.18060745009222 ,
 0.7372099161148071 , 105.1114178684703 ,
 0.7571526169776917 , 86.41721998932883 ,
 2.573166847229004 , 4520.067304835487 ,
 2.712501287460327 , 4415.748863716983 ,
 0.5184374451637268 , 47.58262780840109 ,
 0.5676319599151611 , 27.55481871849925 ,
 0.6194509267807007 , 69.2094715864754 ,
 0.7278637290000916 , 78.43733919026656 ,
 0.5496928095817566 , 67.96948962880998 ,
 0.22372107207775116 , 18.031916779025757 ,
 0.4185275435447693 , 1193.0017838682716 ,
 0.42952319979667664 , 586.5367020654347 ,
 2.6654744148254395 , 3769.250700168913 ,
 0.3506320118904114 , 54.351486873048756 ,
 0.5859532356262207 , 59.018980384996546 ,
 2.680788516998291 , 4450.210528100841 ,
 2.5048279762268066 , 4415.704873943219 ,
 2.666210651397705 , 4461.459985772795 ,
 0.1611899584531784 , 74.02085505632346 ,
 0.29314371943473816 , 53.29789664059502 ,
 0.389975905418396 , 53.03646758940979 ,
 2.743922233581543 , 4224.423371723395 ,
 0.6383959650993347 , 59.140464238848665 ,
 0.7433153390884399 , 39.68318592799004 ,
 0.4827236533164978 , 56.1396298469759 ,
 3.016942024230957 , 3836.2184633642746 ,
 2.4844839572906494 , 4168.624405451372 ,
 0.3949296772480011 , 65.05563506535873 ,
 0.3011570870876312 , 115.62564650394783 ,
 2.8437869548797607 , 2979.8413048892216 ,
 0.35993608832359314 , 57.24899853951674 ,
 0.45037248730659485 , 16.797201070953395 ,
 0.3101547360420227 , 56.15881924149474 ,
 2.786223888397217 , 4312.4438827786025 ,
 0.20456509292125702 , 18.761269481613553 ,
 2.783104181289673 , 4289.864889988114 ,
 0.43699654936790466 , 40.95017343164088 ,
 0.37206795811653137 , 53.77467355948437 ,
 3.6070504188537598 , 3490.307918978862 ,
 0.29531046748161316 , 44.178265278019865 ,
 0.45288291573524475 , 34.800903793552656 ,
 0.3265438675880432 , 38.3364643796113 ,
 0.31433728337287903 , 56.593686080421506 ,
 0.3156857490539551 , 61.75127709547216 ,
 2.7892374992370605 , 4433.489784700443 ,
 0.3928215205669403 , 27.029041677036936 ,
 2.723315954208374 , 4401.266662554548 ,
 0.25815558433532715 , 18.8975939007866 ,
 0.3832409977912903 , 56.15719394646508 ,
 0.5225744247436523 , 66.44553474567945 ,
 0.22046661376953125 , 23.494325216383423 ,
 0.7255532741546631 , 62.63101862377789 ,
 0.6878325939178467 , 202.29652016063977 ,
 0.404125839471817 , 28.55875767466042 ,
 0.323097825050354 , 46.913327741331464 ,
 0.37872153520584106 , 36.88452357422708 ,
 0.30698537826538086 , 54.10056230867512 ,
 0.5485210418701172 , 50.76232081148234 ,
 0.5201008915901184 , 60.71172292286586 ,
 0.356690376996994 , 49.89609936737591 ,
 0.3113264739513397 , 47.56297221435543 ,
 0.4131276309490204 , 53.60348073659658 ,
 0.6459817886352539 , 40.78409118860193 ,
 0.2559570074081421 , 24.102139536400117 ,
 0.3978846073150635 , 80.74917468057824 ,
 0.4098081588745117 , 42.133617072832415 ,
 0.8295888304710388 , 38.4058302857221 ,
 0.37353140115737915 , 42.1785269808185 ,
 0.2882896065711975 , 54.297612565390594 ,
 0.331861287355423 , 32.699248711096516 ,
 0.778771698474884 , 55.01802522739624 ,
 0.2965552508831024 , 50.84453489880949 ,
 0.40333113074302673 , 55.8877605952171 ,
 0.44659674167633057 , 29.488852111411617 ,
 0.22942222654819489 , 14.105892011350974 ,
 0.6290704011917114 , 55.723833654254186 ,
 0.46260866522789 , 12.672498369019593 ,
 0.36226826906204224 , 44.86919191132916 ,
 3.116433620452881 , 4130.407034687294 ,
 2.698202610015869 , 4426.285251160698 ,
 0.7769439220428467 , 59.77492856314718 ,
 0.3318597376346588 , 22.136382498248445 ,
 0.586692750453949 , 16.8107378854257 ,
 0.9830260276794434 , 22.036261407719653 ,
 2.6476223468780518 , 4351.965171005906 ,
 2.595775842666626 , 4472.337656705992 ,
 0.3188295066356659 , 21.35933392352152 ,
 0.3567875623703003 , 32.72812233887841 ,
 3.0430524349212646 , 4329.433376354855 ,
 0.2919601500034332 , 40.87172694592235 ,
 0.6097459197044373 , 22.080184285708363 ,
 2.64581298828125 , 4250.8420453719355 ,
 0.3256169259548187 , 47.63604243231221 ,
 0.9496774673461914 , 31.317565898604947 ,
 2.6173105239868164 , 4466.082519442976 ,
 2.7349419593811035 , 4464.059683603073 ,
 2.692666530609131 , 4454.710972620189 ,
 2.6433610916137695 , 4154.958390982341 ,
 0.5964510440826416 , 10.680384318456575 ,
 0.3753402531147003 , 11.034210606549866 ,
 0.26052126288414 , 37.33305302224166 ,
 0.38161101937294006 , 67.1859479989833 ,
 0.3770228624343872 , 47.89911255631043 ,
 0.3120904862880707 , 33.231138327353946 ,
 2.735511302947998 , 4439.1875953723375 ,
 4.060966491699219 , 3475.863805987085 ,
 2.710631847381592 , 4425.684371232019 ,
 0.2877335548400879 , 19.09603080423998 ,
 0.24221529066562653 , 18.560047523193823 ,
 0.29210153222084045 , 52.07636580590186 ,
 0.36651313304901123 , 61.32515997738941 ,
 0.5789874196052551 , 78.77322358068761 ,
 0.5449180006980896 , 62.88478724275446 ,
 0.3525996208190918 , 39.538340759803916 ,
 0.33386749029159546 , 15.928739931793238 ,
 0.4324253499507904 , 45.47449140365004 ,
 0.3380102515220642 , 42.95530830953099 ,
 0.32599499821662903 , 58.91536936092682 ,
 0.3445042669773102 , 60.384466545796855 ,
 0.2878842055797577 , 60.05901343525478 ,
 0.339076966047287 , 58.88665184520629 ,
 3.1913719177246094 , 1592.9379561804744 ,
 0.5919800996780396 , 40.86711166725347 ,
 2.5488550662994385 , 4394.387771620788 ,
 2.6657521724700928 , 4488.754862665016 ,
 0.3526611328125 , 40.14751001381276 ,
 0.4408843219280243 , 101.63961169638375 ,
 0.25541195273399353 , 18.18955871401868 ,
 0.5647481083869934 , 50.040400272119925 ,
 2.789231538772583 , 4451.311443766188 ,
 0.4454769790172577 , 19.668559295224902 ,
 0.2781629264354706 , 54.864849789395265 ,
 2.8718600273132324 , 4377.5537987951675 ,
 2.9245665073394775 , 4383.460627161013 ,
 0.30205294489860535 , 50.99398926688676 ,
 2.9073448181152344 , 4389.032160497678 ,
 0.32431358098983765 , 57.787666186048725 ,
 0.33806082606315613 , 16.56373237281039 ,
 2.9933249950408936 , 4217.545383759713 ,
 0.37851575016975403 , 23.06333598394268 ,
 0.6126631498336792 , 65.79785693300138 ,
 2.8117477893829346 , 4415.622838733582 ,
 0.24992303550243378 , 56.34529477256075 ,
 0.41750091314315796 , 13.614150775592783 ,
 0.7516945004463196 , 43.17859053833028 ,
 2.681126117706299 , 4381.558703280253 ,
 0.3715975284576416 , 22.385106169131035 ,
 0.6246950030326843 , 27.897625550127962 ,
 0.4725845754146576 , 84.03331234309718 ,
 0.09770110249519348 , 41.61610473926376 ,
 0.2653719484806061 , 27.454444314952685 ,
 0.33324265480041504 , 43.29811665508282 ,
 2.851320505142212 , 4371.560494926628 ,
 0.38165482878685 , 47.90906453863284 ,
 0.32308560609817505 , 53.14912390333231 ,
 0.31685471534729004 , 28.444524886741434 ,
 0.38499870896339417 , 54.50066452332906 ,
 0.34039947390556335 , 44.570553345847685 ,
 0.34671106934547424 , 56.44429136234054 ,
 0.44612082839012146 , 45.80393561348206 ,
 2.5656516551971436 , 4477.721616464678 ,
 0.2819994390010834 , 33.87191861672355 ,
 2.5880606174468994 , 4532.504880962346 ,
 3.6633660793304443 , 4184.972181853966 ,
 2.7704989910125732 , 4303.848416251553 ,
 0.34396958351135254 , 49.17188626760066 ,
 0.31543514132499695 , 51.82526546501779 ,
 0.3303583264350891 , 48.820490982101454 ,
 3.0546722412109375 , 4308.955836746642 ,
 2.6267647743225098 , 4383.179357880403 ,
 0.6355067491531372 , 15.992026601502564 ,
 0.34454482793807983 , 26.89623549613818 ,
 2.567862033843994 , 4495.150150675743 ,
 3.7181220054626465 , 3616.2076015461366 ,
 0.3604057729244232 , 52.97397625088102 ,
 2.7792906761169434 , 4442.653889982808 ,
 0.3765971064567566 , 26.018700359160494 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(500):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(10*i+5),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Sweep-V2 (Med)',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()

returns = []
path = './data/sparse-point-robot'
for i in range(50):
    for j in range(45):
        file_name = path+'/goal_idx%d'%i+'/trj_evalsample%d_step4800.npy'%j
        traj = np.load(file_name,allow_pickle=1)
        returns.append(sum(s[2] for s in traj))


average_return = np.mean(returns)
std_return = np.std(returns)

return_plots = np.zeros(30)
for r in returns:
 idx = int(np.floor(r/-1))
 # print(idx)
 return_plots[idx]+=1
return_plots /=len(returns)


array = [
 0.5192564725875854 , -16.088952650804192 ,
 2.776614189147949 , -35.9809796565156 ,
 1.777470350265503 , -29.991168235119588 ,
 0.08828869462013245 , -5.818900642271864 ,
 2.6604390144348145 , -34.54142508948824 ,
 1.2443491220474243 , -25.350739567428093 ,
 2.7939114570617676 , -35.72487963185073 ,
 0.17740747332572937 , -9.94040212793537 ,
 0.3066672086715698 , -12.67946106001145 ,
 0.7904353737831116 , -19.869782576555885 ,
 0.38862332701683044 , -13.992468235561685 ,
 2.7682034969329834 , -35.89523024940989 ,
 1.2420679330825806 , -25.505977350621336 ,
 2.5893006324768066 , -34.10156793635058 ,
 0.08767317235469818 , -5.562543685940523 ,
 1.8405826091766357 , -30.178133200863876 ,
 0.7054710388183594 , -18.809970769798394 ,
 0.16034892201423645 , -9.324537855045294 ,
 2.7256007194519043 , -35.10985793737351 ,
 0.10579043626785278 , -7.021536346433873 ,
 0.6336506009101868 , -17.68819547584501 ,
 2.7356581687927246 , -35.546566544846314 ,
 0.08858710527420044 , -5.573837586736157 ,
 2.048313617706299 , -31.14267099854762 ,
 0.2511032819747925 , -11.430575558968084 ,
 1.3698033094406128 , -26.828892212615212 ,
 0.9237147569656372 , -21.720938712194574 ,
 0.13759461045265198 , -8.429587034395846 ,
 0.42685696482658386 , -14.644628150141855 ,
 2.628760814666748 , -34.359028379455154 ,
 1.9517245292663574 , -29.9128826752081 ,
 0.27997487783432007 , -12.027811802188486 ,
 0.17736464738845825 , -9.517781332553056 ,
 0.9649360179901123 , -22.74845058067715 ,
 0.09187903255224228 , -4.194136009036087 ,
 2.3344860076904297 , -33.013124321399374 ,
 0.4398288428783417 , -16.22699762250167 ,
 1.6282458305358887 , -27.525190483031682 ,
 0.11774121224880219 , -6.663985169865585 ,
 0.10166112333536148 , -5.6724869439106 ,
 1.0976200103759766 , -23.506802948471623 ,
 0.3008226752281189 , -12.456234667080658 ,
 0.1396530419588089 , -7.978708040027203 ,
 2.3098201751708984 , -32.83361662007238 ,
 0.4349713921546936 , -16.228754843309186 ,
 0.10991819947957993 , -6.232330391383043 ,
 1.820919156074524 , -28.819706905030028 ,
 0.09189282357692719 , -4.212573930646562 ,
 0.6694554090499878 , -19.751841386172284 ,
 2.059436321258545 , -30.9655719746031 ,
 1.6073766946792603 , -27.25498735928745 ,
 0.32441434264183044 , -12.901898516816756 ,
 0.15642493963241577 , -8.928523849346888 ,
 2.2667455673217773 , -32.54895972919825 ,
 0.09511760622262955 , -4.886049415042569 ,
 0.5929886102676392 , -18.8018791050459 ,
 0.3202691674232483 , -13.863769184717885 ,
 0.15530364215373993 , -8.200070195950309 ,
 1.0531845092773438 , -23.075723003537433 ,
 1.9331390857696533 , -29.914294891230668 ,
 1.3704569339752197 , -25.308959342927672 ,
 0.4210686981678009 , -14.641270209471182 ,
 0.11176051199436188 , -7.0426101315177165 ,
 2.1148695945739746 , -31.468846725656206 ,
 0.5016424655914307 , -17.479385871960602 ,
 0.1384706199169159 , -7.726418705942684 ,
 1.7504483461380005 , -28.533759768824805 ,
 0.2350529283285141 , -12.06947056754992 ,
 0.8357516527175903 , -20.943958517983425 ,
 0.24428406357765198 , -10.701558582080082 ,
 0.47521722316741943 , -15.408341185004762 ,
 2.031541347503662 , -30.863132641620023 ,
 0.28331077098846436 , -13.570397309905871 ,
 1.2747918367385864 , -24.468321269887557 ,
 0.0983014777302742 , -5.676952498664245 ,
 0.11303065717220306 , -7.5422073237506675 ,
 0.7557032704353333 , -20.027181858041274 ,
 0.24917270243167877 , -10.931072203533262 ,
 1.5770187377929688 , -27.030916102962735 ,
 1.7653255462646484 , -28.779980953471902 ,
 1.0899311304092407 , -22.690267294021663 ,
 0.8075505495071411 , -19.695541426943244 ,
 0.08905915170907974 , -5.78299103865516 ,
 0.274755597114563 , -13.402770741770322 ,
 0.3231179714202881 , -12.75513102098625 ,
 1.6352463960647583 , -27.88103043918421 ,
 0.11417859047651291 , -8.54696934244999 ,
 0.47097617387771606 , -15.256170384348538 ,
 0.6733256578445435 , -18.521961323380904 ,
 0.13797937333583832 , -8.33306837360617 ,
 0.1452583521604538 , -8.719860659296966 ,
 1.3162188529968262 , -25.075193762286393 ,
 0.3133104145526886 , -13.884665059196795 ,
 0.8413336873054504 , -20.31247685151116 ,
 0.09588757902383804 , -7.378479003093159 ,
 0.8521472215652466 , -20.248734101592454 ,
 0.45810747146606445 , -15.088911793589581 ,
 0.09011471271514893 , -6.03510700943739 ,
 0.15456156432628632 , -10.335766075312781 ,
 0.3320401906967163 , -12.91134504889382 ,
 0.3510426878929138 , -13.443570228286239 ,
 1.3960902690887451 , -25.89300699471292 ,
 0.13295403122901917 , -9.37442648794165 ,
 0.9347612261772156 , -21.12526649744754 ,
 0.6619538068771362 , -17.975572243735918 ,
 0.08543241769075394 , -5.3368281614008115 ,
 0.6113113164901733 , -17.36738898332277 ,
 0.36167365312576294 , -14.109702561631014 ,
 0.13798776268959045 , -8.753713219728528 ,
 1.0911060571670532 , -22.924681739873417 ,
 0.08573880791664124 , -5.856948781016662 ,
 1.2305901050567627 , -24.357673204506042 ,
 0.8285382390022278 , -20.127178576259457 ,
 0.6432768702507019 , -17.758560178613397 ,
 0.22235721349716187 , -11.07874097940292 ,
 0.25457990169525146 , -12.263252642629462 ,
 0.5336044430732727 , -16.134558789094005 ,
 1.0266817808151245 , -22.08206783606995 ,
 1.1361788511276245 , -23.540891532204952 ,
 0.10958369821310043 , -8.012418389800835 ,
 0.3936486840248108 , -13.833816046851123 ,
 1.4372371435165405 , -26.235371830393788 ,
 0.29072636365890503 , -13.365950177832032 ,
 0.0881287157535553 , -5.067687710612923 ,
 0.8600630760192871 , -20.375419109312748 ,
 0.9289864301681519 , -21.464127459260578 ,
 0.1442081183195114 , -8.538186663298237 ,
 0.10458875447511673 , -7.818892292655686 ,
 0.49157482385635376 , -16.258503116159215 ,
 1.0393261909484863 , -22.327514951650578 ,
 0.6254338026046753 , -17.672669900057013 ,
 1.5241726636886597 , -26.962697593999298 ,
 0.12008549273014069 , -8.696527684206208 ,
 0.11220180243253708 , -6.956277539800158 ,
 0.5575351715087891 , -17.220173548981446 ,
 0.3400573134422302 , -12.834495583584367 ,
 0.9432875514030457 , -21.272876074859735 ,
 0.08992163091897964 , -4.92653040397538 ,
 1.3275443315505981 , -24.963453178659954 ,
 0.3253943622112274 , -14.124031990024427 ,
 1.5076253414154053 , -26.55831471597698 ,
 0.5331826210021973 , -16.640673370996065 ,
 0.18602462112903595 , -10.983256715907501 ,
 0.10275106132030487 , -5.546436303616132 ,
 1.0687646865844727 , -22.798124654784708 ,
 0.2271519899368286 , -10.31094808349823 ,
 1.865576982498169 , -29.451038814358487 ,
 0.10018941760063171 , -5.021417244357055 ,
 0.4878555238246918 , -17.043173991569027 ,
 0.7017985582351685 , -19.473195288064932 ,
 1.9629911184310913 , -30.195411776180677 ,
 0.44278714060783386 , -15.291617209946168 ,
 0.2941473126411438 , -13.720674217282003 ,
 0.09978917241096497 , -4.171712594101629 ,
 0.96452796459198 , -22.117817442348855 ,
 1.5912954807281494 , -27.228953150482138 ,
 0.16564568877220154 , -8.371304451502683 ,
 0.14409995079040527 , -8.818479281542746 ,
 0.2645570933818817 , -11.503736983437486 ,
 1.266506314277649 , -24.5106834295561 ,
 0.1332516074180603 , -7.010996338138377 ,
 2.0936226844787598 , -31.156847907890423 ,
 0.6889917850494385 , -19.768119481386435 ,
 0.18246352672576904 , -10.146480158539825 ,
 0.3960082232952118 , -14.598841022377522 ,
 1.3386210203170776 , -25.277188416154285 ,
 1.7270009517669678 , -28.29981203383481 ,
 0.10064950585365295 , -4.013583205066365 ,
 0.3665224313735962 , -15.095342470941382 ,
 0.12937653064727783 , -7.115598373531471 ,
 2.172264337539673 , -32.00833086315202 ,
 0.32093051075935364 , -13.256103831682678 ,
 0.4253119230270386 , -16.056023996464713 ,
 1.6909668445587158 , -27.892215400484623 ,
 0.10295451432466507 , -4.031679944802728 ,
 0.9137237071990967 , -22.13138932826462 ,
 0.17046159505844116 , -9.268194606512704 ,
 1.9065592288970947 , -29.681800088627803 ,
 0.16608773171901703 , -8.826285076273424 ,
 0.11252730339765549 , -5.7674165123678485 ,
 2.1134238243103027 , -31.00867838621369 ,
 0.15962836146354675 , -9.344387392345391 ,
 0.5169920325279236 , -17.115324536849812 ,
 0.1342899203300476 , -7.070361206595738 ,
 2.4651412963867188 , -33.78775026826898 ,
 0.32333940267562866 , -12.730474814148339 ,
 0.9413670897483826 , -22.701302484785128 ,
 1.5739030838012695 , -27.685392361494372 ,
 2.374904155731201 , -32.88172141288088 ,
 0.10238544642925262 , -5.50161828147837 ,
 2.42508602142334 , -33.16356932540523 ,
 0.10520283877849579 , -6.067659424221302 ,
 0.6650476455688477 , -18.78540212279413 ,
 1.569054126739502 , -28.071488134572665 ,
 0.26725900173187256 , -11.603306119847637 ,
 2.612975597381592 , -34.62477747123968 ,
 1.1082701683044434 , -24.313105866433087 ,
 0.5043797492980957 , -15.784249257924634 ,
 2.0996971130371094 , -31.166302555994278 ,
 0.10145293176174164 , -6.494740239190058 ,
 0.26453375816345215 , -11.528658578606699 ,
 2.712510108947754 , -35.54069533890946 ,
 1.3678969144821167 , -26.777526302871905 ,
 2.3937935829162598 , -32.86099952899586 ,
 0.09924552589654922 , -6.335934435602524 ,
 0.5950708389282227 , -17.549920282077444 ,
 0.11395855247974396 , -7.127367107217365 ,
 2.6020243167877197 , -34.50106734823967 ,
 1.8718681335449219 , -29.90158630796726 ,
 0.9931809306144714 , -23.06605891628049 ,
 0.8997136354446411 , -21.96570566808343 ,
 2.5794870853424072 , -34.9205112809675 ,
 0.10254061967134476 , -5.944606843574511 ,
 2.2749056816101074 , -32.14828227275175 ,
 0.3218943178653717 , -12.791449311310664 ,
 1.6402363777160645 , -28.579356495815404 ,
 2.5183756351470947 , -33.84257686380752 ,
 0.5718902945518494 , -17.23681891663143 ,
 0.2008318156003952 , -9.948385910754537 ,
 1.924445390701294 , -30.30406227215581 ,
 0.1660992056131363 , -10.502845482236562 ,
 1.6829745769500732 , -28.299598207569804 ,
 0.701888382434845 , -18.888380966260463 ,
 0.9311602115631104 , -21.271126823117367 ,
 0.09828340262174606 , -5.54323437425885 ,
 1.373216986656189 , -25.36928646327031 ,
 0.47002533078193665 , -16.52087044568637 ,
 0.310068279504776 , -12.24940337864628 ,
 0.1042521670460701 , -7.314592468878326 ,
 1.175905466079712 , -23.61386295092671 ,
 0.10331227630376816 , -5.784038592756821 ,
 2.4376044273376465 , -33.70023612751656 ,
 0.8179745078086853 , -21.50265052631153 ,
 0.2097490131855011 , -10.304485287529621 ,
 1.8836978673934937 , -29.372432091322697 ,
 0.3889356255531311 , -14.793223033876226 ,
 0.11002786457538605 , -6.164472477833282 ,
 1.170301914215088 , -24.510386128348266 ,
 2.2328734397888184 , -32.19779980756154 ,
 0.091370590031147 , -4.269926646262325 ,
 1.9830834865570068 , -30.606185858972673 ,
 0.10081344842910767 , -6.360706520457235 ,
 0.5610352158546448 , -16.864425942790323 ,
 2.6270346641540527 , -34.916048409647885 ,
 1.1495468616485596 , -24.697097776542524 ,
 0.2008318156003952 , -9.948385910754537 ,
 2.4278430938720703 , -33.099784295315054 ,
 2.538579225540161 , -34.030227166292306 ,
 0.7627207040786743 , -20.15413428604278 ,
 0.3465408682823181 , -13.335653060907548 ,
 1.6624399423599243 , -27.849480015364147 ,
 0.7496029138565063 , -19.491811164224377 ,
 0.22903569042682648 , -12.317657765644809 ,
 0.8890767097473145 , -20.821937158931014 ,
 0.15881896018981934 , -8.610288804095106 ,
 0.09521134942770004 , -5.578277519614594 ,
 1.2292187213897705 , -24.114589628752235 ,
 0.4035062789916992 , -14.13350256318489 ,
 0.09590411931276321 , -5.049037407625196 ,
 0.6071651577949524 , -18.087344942589066 ,
 2.262934446334839 , -32.33650504148261 ,
 0.11693938076496124 , -6.484970636002812 ,
 0.7118946313858032 , -20.158329581514867 ,
 0.195347398519516 , -9.50128045031298 ,
 1.8502414226531982 , -29.133525011228723 ,
 0.2593923509120941 , -11.974553396875733 ,
 0.3498860001564026 , -14.413146558705384 ,
 1.3834128379821777 , -25.953673469546022 ,
 0.10905227810144424 , -5.035727055373085 ,
 1.0120981931686401 , -23.18552376026692 ,
 0.09086520969867706 , -4.182769517285949 ,
 2.4492640495300293 , -33.759579194036846 ,
 0.8567479848861694 , -21.92974043610731 ,
 1.8554036617279053 , -29.158951495004025 ,
 0.2073567509651184 , -10.351789413639038 ,
 1.363928198814392 , -25.92981430793922 ,
 0.2537473440170288 , -11.561043707407608 ,
 0.48066380620002747 , -16.547788173734588 ,
 2.2520039081573486 , -32.294093127672376 ,
 2.0569276809692383 , -30.5369261931181 ,
 0.21336878836154938 , -10.302126990801337 ,
 2.428924083709717 , -33.652591180610976 ,
 0.22213546931743622 , -10.568516217627094 ,
 1.605869174003601 , -27.590917990680477 ,
 0.5561703443527222 , -18.01242721889639 ,
 0.09191237390041351 , -4.270988493557171 ,
 0.9673575758934021 , -23.067607361779448 ,
 1.978489875793457 , -29.99185698589239 ,
 2.266695022583008 , -32.46754899064454 ,
 0.11002786457538605 , -6.164472477833282 ,
 0.0855855792760849 , -5.955957829117388 ,
 1.526530146598816 , -26.98374293329618 ,
 0.8751910924911499 , -20.714849636268223 ,
 0.48545441031455994 , -16.074974168077887 ,
 0.51224684715271 , -15.95294939280232 ,
 0.1635046899318695 , -9.323774469589681 ,
 0.17203474044799805 , -10.812900374160774 ,
 1.023366928100586 , -22.020007916698024 ,
 0.09364164620637894 , -6.455862181858714 ,
 0.8106013536453247 , -19.777936518539644 ,
 1.8996648788452148 , -30.276765940110817 ,
 0.10269439220428467 , -6.226811742983759 ,
 2.6549041271209717 , -35.11621722553464 ,
 0.682054877281189 , -18.993312565093923 ,
 2.525629997253418 , -33.80802030424377 ,
 1.1336627006530762 , -24.439842127229475 ,
 0.3385080099105835 , -13.137573363968965 ,
 2.374859571456909 , -32.801043528118626 ,
 0.5222705006599426 , -16.162228244877383 ,
 2.6271376609802246 , -34.58579328944579 ,
 0.5373799800872803 , -16.567601482340674 ,
 2.7045087814331055 , -35.49770763640947 ,
 0.09677819162607193 , -6.243904781153861 ,
 2.3560662269592285 , -32.61663767389158 ,
 0.1698639988899231 , -9.177271634988267 ,
 1.6233201026916504 , -28.555706948924385 ,
 0.09902191162109375 , -5.831492952772362 ,
 0.9264888167381287 , -22.211248929196366 ,
 2.6020243167877197 , -34.50106734823967 ,
 0.2665504217147827 , -11.690422314634738 ,
 1.136907935142517 , -23.175161580068572 ,
 0.6827206611633301 , -18.666215250482125 ,
 0.10054098069667816 , -6.315955428140489 ,
 1.7225956916809082 , -28.61473898294819 ,
 0.22022375464439392 , -10.153226681909805 ,
 0.40000566840171814 , -15.638812729546517 ,
 0.16913196444511414 , -10.562308710208535 ,
 0.7231040000915527 , -19.433181241341604 ,
 1.493115782737732 , -26.312936224779524 ,
 0.09452942758798599 , -4.594366618593579 ,
 1.377931833267212 , -25.298652040099302 ,
 0.567216157913208 , -16.84785830951703 ,
 0.09395088255405426 , -6.437665121737945 ,
 0.45919516682624817 , -16.78096456484856 ,
 0.18199530243873596 , -9.330725561201518 ,
 1.9145400524139404 , -30.01794436350706 ,
 0.35386723279953003 , -13.042935548410787 ,
 0.958598256111145 , -21.781799349453976 ,
 0.2225627452135086 , -12.186556699398578 ,
 0.08858981728553772 , -4.721312985767692 ,
 0.8023732304573059 , -21.149269157811602 ,
 0.1304844319820404 , -7.943558759838418 ,
 2.5708138942718506 , -34.56413607260825 ,
 1.96478271484375 , -30.136031940679608 ,
 0.15088792145252228 , -8.318572330472012 ,
 2.3416168689727783 , -32.631329155347686 ,
 0.36661267280578613 , -13.832078228590133 ,
 0.09135463088750839 , -4.640231715902586 ,
 0.564934253692627 , -17.45481953807859 ,
 1.3563388586044312 , -26.391551734797332 ,
 1.8426547050476074 , -30.044689217493442 ,
 0.09639601409435272 , -5.622606481415816 ,
 2.6266355514526367 , -35.278331831108616 ,
 0.3927173614501953 , -14.154173178132279 ,
 0.914061427116394 , -21.84574402732266 ,
 2.56333065032959 , -33.95912454860432 ,
 0.18744006752967834 , -10.077613642579227 ,
 1.316530704498291 , -26.179138412657544 ,
 0.6904515027999878 , -18.45633592878071 ,
 2.646946907043457 , -34.72564723067623 ,
 2.037814140319824 , -30.587941715091308 ,
 0.21910786628723145 , -11.049882404492434 ,
 0.3821958005428314 , -14.817504740897165 ,
 0.11713359504938126 , -6.005231887059726 ,
 1.121405005455017 , -24.196501984179516 ,
 2.3361217975616455 , -33.043957217874635 ,
 0.708607017993927 , -20.114575046608774 ,
 1.6103132963180542 , -27.596755470147766 ,
 0.10720063745975494 , -5.7713951408088935 ,
 0.24509981274604797 , -11.142609248101275 ,
 1.4568219184875488 , -26.709025515087237 ,
 0.11230014264583588 , -6.565430376001855 ,
 2.505559206008911 , -34.13649803180006 ,
 0.18904128670692444 , -9.530294459290104 ,
 0.5420148372650146 , -17.43205007880111 ,
 2.1994118690490723 , -31.66461058959478 ,
 0.8870130181312561 , -22.29099115089103 ,
 0.09165515750646591 , -4.575011164581862 ,
 1.9928412437438965 , -30.145512315989276 ,
 0.17795345187187195 , -9.551397881216285 ,
 0.10935288667678833 , -8.208405985504728 ,
 1.678553819656372 , -28.224242342512266 ,
 0.7685261964797974 , -19.45859510921666 ,
 0.842560887336731 , -20.263019709620888 ,
 0.20572465658187866 , -10.187641929208754 ,
 0.36472558975219727 , -14.869891993457772 ,
 0.08704665303230286 , -5.411659156630244 ,
 0.4415600895881653 , -14.780592915080092 ,
 1.3571089506149292 , -25.409574771976924 ,
 1.1348567008972168 , -23.1289439032326 ,
 0.2985422611236572 , -12.580026303054245 ,
 1.1504666805267334 , -23.267757021756292 ,
 0.2763241231441498 , -12.75895682068004 ,
 1.1148561239242554 , -23.345613060375904 ,
 0.09500259160995483 , -6.979593267030467 ,
 0.6801815032958984 , -18.23039275793644 ,
 0.09160985052585602 , -6.522863132668763 ,
 0.6961976289749146 , -18.42309037779789 ,
 0.5158330202102661 , -15.821235415341746 ,
 0.15351320803165436 , -9.172789104174525 ,
]

error_array = np.array(array).reshape(-1,2)
plt.figure()
# print(error_array[0,:5],np.array(array).reshape(-1,2)[:5,0])
max_length = int(np.max(error_array[:,0]))+2
for i in range(30):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(-1*i+0),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(error_array[:,1],error_array[:,0])
plt.title('Prediction Error, Point-Robot',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
# #plt.show()

std_array = [
 0.40243881940841675 , -27.69942903098669 ,
 0.4317864775657654 , -6.164702636100546 ,
 0.43450891971588135 , -35.52983743138805 ,
 0.39348965883255005 , -13.907200503090946 ,
 0.4141983687877655 , -21.286952202411307 ,
 0.4032088816165924 , -32.46570560782102 ,
 0.39812034368515015 , -7.127367107217365 ,
 0.40508586168289185 , -34.103906790028645 ,
 0.398150771856308 , -17.549920282077444 ,
 0.4065011441707611 , -30.253316714257323 ,
 0.43450891971588135 , -6.168505197267033 ,
 0.4333510398864746 , -34.92619299724692 ,
 0.4112374782562256 , -22.87651847818362 ,
 0.39480721950531006 , -32.14828227275175 ,
 0.4023202657699585 , -13.335653060907548 ,
 0.39742785692214966 , -28.79906925879638 ,
 0.40243881940841675 , -18.093787634920982 ,
 0.4057092070579529 , -10.441995919339577 ,
 0.3993721306324005 , -34.030227166292306 ,
 0.3947312831878662 , -33.386333559184 ,
 0.4317864775657654 , -28.182189539551512 ,
 0.43868106603622437 , -19.10577364309533 ,
 0.4112374782562256 , -9.653972908523688 ,
 0.39480721950531006 , -21.271126823117367 ,
 0.4057224690914154 , -9.871061301920712 ,
 0.4045497477054596 , -4.535568372950279 ,
 0.3993721306324005 , -25.013435444869447 ,
 0.39723631739616394 , -16.253844658935176 ,
 0.4051826596260071 , -13.653588579840113 ,
 0.40642595291137695 , -5.986406543053418 ,
 0.4198566675186157 , -9.751890560927137 ,
 0.43868106603622437 , -33.70023612751656 ,
 0.4112374782562256 , -18.01242721889639 ,
 0.39480721950531006 , -5.784038592756821 ,
 0.4060407876968384 , -28.80237810752193 ,
 0.40778931975364685 , -24.510386128348266 ,
 0.39742785692214966 , -10.842543162251372 ,
 0.4051826596260071 , -31.48679615431138 ,
 0.39724645018577576 , -5.148317165329197 ,
 0.4094846248626709 , -22.013736976118512 ,
 0.4317864775657654 , -34.916048409647885 ,
 0.4102487564086914 , -6.482424349260268 ,
 0.39723631739616394 , -28.579356495815404 ,
 0.4091923236846924 , -16.573427357360732 ,
 0.3946678042411804 , -33.099784295315054 ,
 0.4112374782562256 , -22.87651847818362 ,
 0.40566402673721313 , -11.591292719257911 ,
 0.3942497968673706 , -30.735918895244705 ,
 0.3993721306324005 , -34.030227166292306 ,
 0.43560922145843506 , -6.167481848805778 ,
 0.3974652588367462 , -15.565051588314814 ,
 0.4112668037414551 , -15.677294371924084 ,
 0.4338673949241638 , -27.987345943338784 ,
 0.4045497477054596 , -4.53166013626744 ,
 0.3961942791938782 , -22.834608777676678 ,
 0.4057224690914154 , -10.372415101836554 ,
 0.4112374782562256 , -9.207151092326264 ,
 0.3993721306324005 , -24.61355345494106 ,
 0.3945962190628052 , -19.71887262232686 ,
 0.43868106603622437 , -19.54310662523835 ,
 0.4312654137611389 , -32.62338687596719 ,
 0.4124513566493988 , -8.192484285224841 ,
 0.39742785692214966 , -23.637111133792164 ,
 0.4045497477054596 , -10.651595563757303 ,
 0.3961942791938782 , -29.338424644580943 ,
 0.4057092070579529 , -4.333893251920343 ,
 0.41441580653190613 , -16.445981107182384 ,
 0.4083319902420044 , -31.50078105614664 ,
 0.3945962190628052 , -26.86150600080205 ,
 0.4023202657699585 , -6.326974825643848 ,
 0.39724645018577576 , -4.848748918954617 ,
 0.43868106603622437 , -33.89764938344173 ,
 0.4084138572216034 , -21.92974043610731 ,
 0.39723631739616394 , -11.561043707407608 ,
 0.40566402673721313 , -29.46279759814204 ,
 0.433014452457428 , -10.351789413639038 ,
 0.4101216793060303 , -17.550469880678122 ,
 0.4069151282310486 , -25.92981430793922 ,
 0.3907099664211273 , -6.427236146946101 ,
 0.4102487564086914 , -32.39455133633894 ,
 0.4032088816165924 , -28.636880770680335 ,
 0.433014452457428 , -10.764167134625744 ,
 0.3974652588367462 , -11.327213878572802 ,
 0.4370025396347046 , -33.652591180610976 ,
 0.4084138572216034 , -21.50265052631153 ,
 0.3947312831878662 , -4.269926646262325 ,
 0.4051826596260071 , -31.48679615431138 ,
 0.4101216793060303 , -17.109306757926007 ,
 0.3945962190628052 , -6.972719061767851 ,
 0.40642595291137695 , -26.384119346261947 ,
 0.41538602113723755 , -18.982255650524635 ,
 0.43560922145843506 , -26.98374293329618 ,
 0.4101216793060303 , -6.976443727003431 ,
 0.39353665709495544 , -11.952571072656253 ,
 0.4023202657699585 , -17.55728160496847 ,
 0.39723631739616394 , -6.62461916725899 ,
 0.4084138572216034 , -10.812900374160774 ,
 0.39724645018577576 , -15.56747073675712 ,
 0.409550279378891 , -23.855768161299434 ,
 0.4089449644088745 , -20.932689344114674 ,
 0.3942497968673706 , -31.308937081248345 ,
 0.4241395890712738 , -5.5556100065163045 ,
 0.4094846248626709 , -20.10419497573978 ,
 0.4338673949241638 , -35.14189167933345 ,
 0.4060407876968384 , -13.021510082557276 ,
 0.4106234312057495 , -26.54692845317253 ,
 0.39724645018577576 , -34.229107049072695 ,
 0.4067150950431824 , -10.398208218751646 ,
 0.4065011441707611 , -16.162228244877383 ,
 0.39742785692214966 , -29.43563493684801 ,
 0.4032088816165924 , -32.46570560782102 ,
 0.433014452457428 , -6.328565593608722 ,
 0.3974652588367462 , -16.764424968655483 ,
 0.3946678042411804 , -9.436001144113018 ,
 0.4370025396347046 , -35.49770763640947 ,
 0.4084138572216034 , -26.29971252167252 ,
 0.3942497968673706 , -13.823911322555121 ,
 0.4101216793060303 , -22.211248929196366 ,
 0.40542468428611755 , -34.39797032908637 ,
 0.4030894637107849 , -6.464637498356146 ,
 0.433014452457428 , -28.61473898294819 ,
 0.43450891971588135 , -18.42314477361783 ,
 0.41351476311683655 , -10.562308710208535 ,
 0.3945962190628052 , -20.631284161741704 ,
 0.4032088816165924 , -8.363671459440903 ,
 0.4045497477054596 , -4.599078512912015 ,
 0.4051826596260071 , -13.17432518019124 ,
 0.3974652588367462 , -16.514124308554486 ,
 0.3993721306324005 , -25.40798149832502 ,
 0.3946678042411804 , -23.43977624687868 ,
 0.4112668037414551 , -27.70905065438375 ,
 0.4338673949241638 , -16.84785830951703 ,
 0.4101216793060303 , -10.824897286029909 ,
 0.39480721950531006 , -7.237762749648804 ,
 0.4065011441707611 , -19.926545972505558 ,
 0.39724645018577576 , -11.239044768360518 ,
 0.40760356187820435 , -24.63714292133179 ,
 0.39723631739616394 , -5.536401439049577 ,
 0.43868106603622437 , -30.15457662854515 ,
 0.40976375341415405 , -13.930905315024159 ,
 0.4045497477054596 , -26.391551734797332 ,
 0.433014452457428 , -8.381257028245024 ,
 0.43868106603622437 , -34.76616040139566 ,
 0.3973098397254944 , -12.494095424957054 ,
 0.3947312831878662 , -5.7917725736924535 ,
 0.4089449644088745 , -32.07775294297838 ,
 0.4112374782562256 , -20.605371120180735 ,
 0.4023202657699585 , -29.721608038805556 ,
 0.4083319902420044 , -5.213394535547844 ,
 0.4112668037414551 , -33.6920303860324 ,
 0.4083319902420044 , -35.19137769035659 ,
 0.4370025396347046 , -5.560228287892167 ,
 0.4112374782562256 , -24.434637862920166 ,
 0.4023202657699585 , -15.334023905448296 ,
 0.39348965883255005 , -31.72575963964578 ,
 0.40508586168289185 , -10.687316495058667 ,
 0.3946678042411804 , -33.95912454860432 ,
 0.4333510398864746 , -35.278331831108616 ,
 0.398150771856308 , -28.973027669011625 ,
 0.40778931975364685 , -18.73018807116354 ,
 0.39485567808151245 , -29.599005825341642 ,
 0.4241395890712738 , -9.898823499975073 ,
 0.4045497477054596 , -11.587580898396636 ,
 0.4312654137611389 , -33.043957217874635 ,
 0.4101216793060303 , -18.681120868150764 ,
 0.40760356187820435 , -4.595862742622155 ,
 0.3974652588367462 , -23.999265993875177 ,
 0.3942497968673706 , -26.714155495462272 ,
 0.40777695178985596 , -31.869561822199156 ,
 0.4023202657699585 , -7.305663970129099 ,
 0.4370025396347046 , -34.222307104435885 ,
 0.433014452457428 , -9.54347331661266 ,
 0.4101216793060303 , -18.425717648394052 ,
 0.4032088816165924 , -29.68944326782842 ,
 0.3946678042411804 , -5.165063195010769 ,
 0.3948027789592743 , -10.059385868398092 ,
 0.40243881940841675 , -24.30099027023168 ,
 0.40542468428611755 , -32.17013083205122 ,
 0.4065011441707611 , -27.12844852171903 ,
 0.3993721306324005 , -4.856633554132999 ,
 0.4060407876968384 , -20.439317610020446 ,
 0.433014452457428 , -19.43911924685584 ,
 0.4106234312057495 , -6.323969334127253 ,
 0.43868106603622437 , -28.224242342512266 ,
 0.40243881940841675 , -13.891208782497497 ,
 0.3907099664211273 , -9.989232543461315 ,
 0.40508586168289185 , -23.339825547785335 ,
 0.39812034368515015 , -14.52337521906031 ,
 0.399929940700531 , -5.911589033682155 ,
 0.40642595291137695 , -17.541483487388856 ,
 0.4106234312057495 , -8.071318428753475 ,
 0.4370025396347046 , -23.29359787908716 ,
 0.4338673949241638 , -24.764756234028606 ,
 0.40642595291137695 , -11.044476905824398 ,
 0.3961942791938782 , -18.79767794543734 ,
 0.4052536189556122 , -17.126898473688893 ,
 0.40243881940841675 , -7.532174116199589 ,
 0.3948027789592743 , -13.747128582829397 ,
 0.41417744755744934 , -5.1841728282304285 ,
 0.4102487564086914 , -19.67381713494022 ,
 0.433014452457428 , -5.825613208816752 ,
 0.43560922145843506 , -35.9809796565156 ,
 0.3973098397254944 , -18.53315972565563 ,
 0.40778931975364685 , -31.216349686030274 ,
 0.40760356187820435 , -35.059054071991866 ,
 0.3951379656791687 , -11.455381784111012 ,
 0.41441580653190613 , -26.23237939766723 ,
 0.39353665709495544 , -14.718959512170239 ,
 0.40976375341415405 , -8.405622063235661 ,
 0.409550279378891 , -35.90476822153896 ,
 0.4069151282310486 , -31.434783382290025 ,
 0.4312654137611389 , -5.538351159435539 ,
 0.42845991253852844 , -35.89523024940989 ,
 0.3973098397254944 , -17.62072511523371 ,
 0.4112374782562256 , -24.992281535341352 ,
 0.3947312831878662 , -11.160462168623301 ,
 0.40542468428611755 , -35.35405955064717 ,
 0.40566402673721313 , -34.10156793635058 ,
 0.40777695178985596 , -8.276377481515404 ,
 0.3907099664211273 , -14.13825749963254 ,
 0.414207398891449 , -35.64735399906752 ,
 0.4333510398864746 , -5.575982091498038 ,
 0.4101216793060303 , -23.79201351266541 ,
 0.3907099664211273 , -13.650190327409357 ,
 0.41068655252456665 , -30.889316350035017 ,
 0.40566402673721313 , -33.86942739508934 ,
 0.4083319902420044 , -7.313120389656838 ,
 0.39723631739616394 , -18.365914680274336 ,
 0.41096603870391846 , -27.3049507997995 ,
 0.3951379656791687 , -9.95242325535113 ,
 0.4101216793060303 , -15.774141806221321 ,
 0.43868106603622437 , -33.0616807026929 ,
 0.433014452457428 , -12.027811802188486 ,
 0.39353665709495544 , -4.336980994572932 ,
 0.4032088816165924 , -27.525190483031682 ,
 0.399929940700531 , -8.969784427326651 ,
 0.40542468428611755 , -30.344949099333615 ,
 0.3993721306324005 , -6.935209532165372 ,
 0.41068655252456665 , -23.932725428916328 ,
 0.40673568844795227 , -19.172144142775803 ,
 0.41538602113723755 , -10.431801293632514 ,
 0.40542468428611755 , -30.01593294507011 ,
 0.41441580653190613 , -16.77233540398283 ,
 0.39348965883255005 , -6.5262586138214305 ,
 0.4065011441707611 , -24.34683234299998 ,
 0.3947312831878662 , -5.544572332497638 ,
 0.4370025396347046 , -32.784779493576785 ,
 0.398150771856308 , -10.432161664006857 ,
 0.4094846248626709 , -20.267836828022357 ,
 0.4032088816165924 , -27.14199274750114 ,
 0.409550279378891 , -30.533183787984242 ,
 0.4338673949241638 , -12.901898516816756 ,
 0.41325563192367554 , -13.510291024981129 ,
 0.41068655252456665 , -23.075723003537433 ,
 0.3945962190628052 , -4.899347630704189 ,
 0.39812034368515015 , -7.502970121133883 ,
 0.40760356187820435 , -28.219309434316166 ,
 0.4094846248626709 , -19.820955598150892 ,
 0.3974652588367462 , -9.141815918437539 ,
 0.4370025396347046 , -32.54895972919825 ,
 0.40760356187820435 , -26.685850606745745 ,
 0.4333510398864746 , -14.641270209471182 ,
 0.398150771856308 , -8.33304085041627 ,
 0.4094846248626709 , -17.996437407152417 ,
 0.3946678042411804 , -6.960415083803971 ,
 0.43450891971588135 , -31.468846725656206 ,
 0.4065011441707611 , -22.195865314497205 ,
 0.3942497968673706 , -4.65253617823733 ,
 0.40976375341415405 , -11.622131898621955 ,
 0.41351476311683655 , -13.510505401875953 ,
 0.40760356187820435 , -25.88319915374252 ,
 0.4338673949241638 , -15.527997119155641 ,
 0.39348965883255005 , -4.3112551270989155 ,
 0.4084138572216034 , -16.54859264206356 ,
 0.4370025396347046 , -30.981490887759893 ,
 0.39812034368515015 , -10.22926191286864 ,
 0.40642595291137695 , -21.75126093070394 ,
 0.398150771856308 , -7.5422073237506675 ,
 0.4101216793060303 , -12.170238712557062 ,
 0.3946678042411804 , -7.8935708307267145 ,
 0.40243881940841675 , -13.402770741770322 ,
 0.4312654137611389 , -19.77192293848589 ,
 0.43560922145843506 , -27.691162239406115 ,
 0.3948027789592743 , -7.810510020682264 ,
 0.40760356187820435 , -21.55254783706136 ,
 0.39724645018577576 , -14.609027846816474 ,
 0.4101216793060303 , -7.7896456675447245 ,
 0.4065011441707611 , -16.585431223211774 ,
 0.4102487564086914 , -24.87227239302053 ,
 0.39353665709495544 , -10.956188448173682 ,
 0.41325563192367554 , -6.307554246805044 ,
 0.433014452457428 , -20.292353936944423 ,
 0.4370025396347046 , -27.480083873129892 ,
 0.4065011441707611 , -16.095285666405626 ,
 0.3907099664211273 , -10.98084566471422 ,
 0.40542468428611755 , -23.037309587132402 ,
 0.39724645018577576 , -15.088911793589581 ,
 0.41096603870391846 , -10.803974339933626 ,
 0.3973098397254944 , -7.330779699902761 ,
 0.4057224690914154 , -20.248734101592454 ,
 0.4101216793060303 , -5.850854630495453 ,
 0.4338673949241638 , -21.98469576657356 ,
 0.43560922145843506 , -25.88149990626271 ,
 0.39480721950531006 , -13.17565744895411 ,
 0.40642595291137695 , -14.584572490832876 ,
 0.4052536189556122 , -20.43302781567219 ,
 0.4094846248626709 , -9.83491893442892 ,
 0.39812034368515015 , -17.36738898332277 ,
 0.4060407876968384 , -17.568097136147053 ,
 0.399929940700531 , -8.753713219728528 ,
 0.43560922145843506 , -23.542644541556044 ,
 0.4198566675186157 , -23.599065107822376 ,
 0.4112374782562256 , -5.401037618086535 ,
 0.3945962190628052 , -14.949046180827382 ,
 0.40642595291137695 , -11.553552434569689 ,
 0.4089449644088745 , -16.639606337836845 ,
 0.40243881940841675 , -8.012418389800835 ,
 0.3951379656791687 , -19.368511727816017 ,
 0.409550279378891 , -19.906783188765534 ,
 0.39723631739616394 , -10.920763569299197 ,
 0.3973098397254944 , -14.72746419942193 ,
 0.43868106603622437 , -21.689124788410385 ,
 0.4312654137611389 , -26.151848159012474 ,
 0.41068655252456665 , -7.495995910753281 ,
 0.4112374782562256 , -7.050810786529071 ,
 0.3946678042411804 , -20.375419109312748 ,
 0.4089449644088745 , -14.169850281865353 ,
 0.4112668037414551 , -18.006467056729072 ,
 0.4030894637107849 , -22.916623917482305 ,
 0.4094846248626709 , -4.936367489843444 ,
 0.3993721306324005 , -23.383245460325067 ,
 0.414207398891449 , -17.672669900057013 ,
 0.4101216793060303 , -8.696527684206208 ,
 0.3942497968673706 , -17.220173548981446 ,
 0.4069151282310486 , -6.956277539800158 ,
 0.4094846248626709 , -4.92653040397538 ,
 0.4312654137611389 , -26.86581893993837 ,
 0.40566402673721313 , -11.48341316462392 ,
 0.398150771856308 , -13.254195792367447 ,
 0.3961942791938782 , -21.526250027780655 ,
 0.4099317789077759 , -28.11652101687434 ,
 0.4241395890712738 , -16.114416329928176 ,
 0.41351476311683655 , -11.936328016962054 ,
 0.39348965883255005 , -20.79486459248723 ,
 0.4057092070579529 , -8.678099843667637 ,
 0.4069151282310486 , -4.245982868753953 ,
 0.3947312831878662 , -25.244572039301307 ,
 0.398150771856308 , -17.043173991569027 ,
 0.41096603870391846 , -8.526566958010083 ,
 0.40542468428611755 , -11.270351052351494 ,
 0.41538602113723755 , -29.469552269809775 ,
 0.4370025396347046 , -15.944644289318632 ,
 0.41351476311683655 , -13.315437954997272 ,
 0.4032088816165924 , -5.447925684561872 ,
 0.39480721950531006 , -24.285298058545848 ,
 0.39723631739616394 , -19.498775001306573 ,
 0.40243881940841675 , -7.608954486679903 ,
 0.40508586168289185 , -9.173911668092408 ,
 0.3951379656791687 , -26.89327419391453 ,
 0.4069151282310486 , -5.009567425368477 ,
 0.40760356187820435 , -6.071348677332847 ,
 0.4333510398864746 , -31.240098733476966 ,
 0.3974652588367462 , -20.62721648884015 ,
 0.4094846248626709 , -10.146480158539825 ,
 0.43450891971588135 , -14.392582865107347 ,
 0.39485567808151245 , -26.791056411077673 ,
 0.4030894637107849 , -29.01066593423458 ,
 0.4112374782562256 , -14.207183181578241 ,
 0.4065011441707611 , -5.621587991970156 ,
 0.4112668037414551 , -10.586086778804823 ,
 0.3993721306324005 , -29.681800088627803 ,
 0.4112668037414551 , -9.265680659090629 ,
 0.41351476311683655 , -16.056023996464713 ,
 0.41068655252456665 , -8.098695182904681 ,
 0.39723631739616394 , -22.13138932826462 ,
 0.39480721950531006 , -26.663307828655054 ,
 0.4338673949241638 , -32.00833086315202 ,
 0.4089449644088745 , -5.202625280929059 ,
 0.3961942791938782 , -28.317718274816844 ,
 0.4084138572216034 , -11.988804485870316 ,
 0.4094846248626709 , -15.625435654542493 ,
 0.4333510398864746 , -33.82756642974379 ,
 0.43868106603622437 , -9.393466582531603 ,
 0.3907099664211273 , -29.6037875128321 ,
 0.40760356187820435 , -6.178754296170184 ,
 0.3974652588367462 , -25.562219637639252 ,
 0.4030894637107849 , -32.505337022017045 ,
 0.4101216793060303 , -20.406611047718705 ,
 0.4040149450302124 , -8.72908464370296 ,
 0.409550279378891 , -5.50161828147837 ,
 0.4040149450302124 , -12.284328233831664 ,
 0.4099317789077759 , -34.48675304440709 ,
 0.39742785692214966 , -28.470691014438334 ,
 0.43450891971588135 , -6.486216950046984 ,
 0.41096603870391846 , -19.72267689183687 ,
 0.3961942791938782 , -33.026851629658246 ,
 0.40542468428611755 , -7.521636357320566 ,
 0.4141983687877655 , -24.313105866433087 ,
 0.3945962190628052 , -31.166302555994278 ,
 0.40778931975364685 , -16.39229278635801 ,
]

std_array = np.array(std_array).reshape(-1,2)
plt.figure()
max_length = int(np.max(std_array[:,0]))+2
for i in range(30):
 print(return_plots[i],i)
 plt.plot(np.ones(max_length)*(-1*i),np.arange(max_length),alpha=np.clip(return_plots[i]*3,0,0.5),linewidth=5,color='r')
plt.scatter(std_array[:,1],std_array[:,0])
plt.title('Prediction Variance, Point-Robot',fontsize=15)
plt.xlabel('Episode Return',fontsize=15)
plt.ylabel('Uncertainty',fontsize=15)
#plt.show()
plt.show()